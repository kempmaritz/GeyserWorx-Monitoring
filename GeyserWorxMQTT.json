[{"id":"5395d339.48846c","type":"tab","label":"Setup","disabled":false,"info":""},{"id":"3dddaeea.f4e652","type":"tab","label":"Data Sampling","disabled":false,"info":""},{"id":"94e0adf3.31d6b","type":"tab","label":"G1 Dashboard","disabled":false,"info":""},{"id":"90588a53.b682a8","type":"tab","label":"G1 Timers","disabled":false,"info":""},{"id":"e34d9a79.0942a8","type":"tab","label":"G2Dashboard","disabled":false,"info":""},{"id":"1d8af5ee.d9dbda","type":"tab","label":"G2Timers","disabled":false,"info":""},{"id":"c8c78f4d.679e8","type":"subflow","name":"csvColumnParser","info":"","category":"","in":[{"x":60,"y":80,"wires":[{"id":"a8857356.d49e68"}]}],"out":[{"x":900,"y":80,"wires":[{"id":"d71e0bef.46647","port":0}]}],"env":[]},{"id":"ebe4365e.c94b18","type":"subflow","name":"Dashboard","info":"","category":"","in":[{"x":60,"y":40,"wires":[{"id":"28f0c64b.f78d7a"}]}],"out":[{"x":640,"y":40,"wires":[{"id":"1fd0e69c.ec9b69","port":0}]},{"x":640,"y":80,"wires":[{"id":"29d6985d.5d8258","port":0}]},{"x":640,"y":120,"wires":[{"id":"d87d151e.0da718","port":0}]},{"x":640,"y":160,"wires":[{"id":"136a01c6.707ebe","port":0}]},{"x":640,"y":200,"wires":[{"id":"a0bd42d7.b3a9c","port":0}]},{"x":640,"y":240,"wires":[{"id":"2b040132.7b33be","port":0}]},{"x":640,"y":280,"wires":[{"id":"a6b2625a.70167","port":0}]},{"x":640,"y":320,"wires":[{"id":"acd27697.bbe018","port":0}]},{"x":640,"y":360,"wires":[{"id":"12b01944.52f177","port":0}]},{"x":640,"y":400,"wires":[{"id":"fbe53d83.501a","port":0}]},{"x":640,"y":440,"wires":[{"id":"fe97ea5b.065858","port":0}]},{"x":640,"y":480,"wires":[{"id":"1c8ff834.ddcad8","port":0}]},{"x":640,"y":520,"wires":[{"id":"85f91d5.8785ce","port":0}]},{"x":640,"y":560,"wires":[{"id":"78cd83e0.e4efcc","port":0}]},{"x":640,"y":600,"wires":[{"id":"7f58b412.8b026c","port":0}]},{"x":640,"y":640,"wires":[{"id":"807ff01c.132b1","port":0}]},{"x":640,"y":680,"wires":[{"id":"bb87cf3a.d914a","port":0}]},{"x":640,"y":720,"wires":[{"id":"10f4fc57.08c844","port":0}]},{"x":640,"y":760,"wires":[{"id":"58bab2d0.f4cfdc","port":0}]},{"x":640,"y":800,"wires":[{"id":"5a71b241.76eb4c","port":0}]},{"x":640,"y":840,"wires":[{"id":"6aeddd83.d288c4","port":0}]}],"env":[],"meta":{},"color":"#87A980","inputLabels":["Trigger"],"outputLabels":["Heading","AC On","PV On","Boost On","AC Setpoint","Boost Setpoint","PV Setpoint","Gauge","G1ACkW","G1PVkW","G1ACCost","G1PVCost","G1PVUsage","G1Carbon","Alarms","AC Current","PV Current","PCB Temperature","AC Enable","AC Boost","PV Enable"],"icon":"node-red/db.svg","status":{"x":200,"y":140,"wires":[{"id":"28f0c64b.f78d7a","port":0}]}},{"id":"65f07aa6.9889a4","type":"subflow","name":"Timer Setting","info":"","category":"","in":[{"x":60,"y":40,"wires":[{"id":"add82985.1b6308"},{"id":"8111e40b.4ef538"}]}],"out":[{"x":320,"y":80,"wires":[{"id":"add82985.1b6308","port":0}]},{"x":320,"y":120,"wires":[{"id":"3978633e.a0480c","port":0}]},{"x":320,"y":160,"wires":[{"id":"efe448f6.98abd8","port":0}]},{"x":320,"y":200,"wires":[{"id":"3851122a.10345e","port":0}]},{"x":320,"y":240,"wires":[{"id":"c3110e2b.578c1","port":0}]},{"x":320,"y":280,"wires":[{"id":"94ace4e0.445df8","port":0}]},{"x":320,"y":320,"wires":[{"id":"fc65d0a1.347a4","port":0}]},{"x":320,"y":360,"wires":[{"id":"61890613.1e8358","port":0}]},{"x":320,"y":400,"wires":[{"id":"7c0ed9c4.487458","port":0}]},{"x":320,"y":440,"wires":[{"id":"664ecef8.2bf12","port":0}]}],"env":[],"meta":{},"color":"#87A980","outputLabels":["Enable Timer","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","On Time","Off Time"],"icon":"node-red/timer.svg","status":{"x":320,"y":40,"wires":[{"id":"8111e40b.4ef538","port":0}]}},{"id":"b0690eac.2cf5f","type":"ui_group","name":"Dashboard","tab":"f0628843.17a088","order":1,"disp":false,"width":"6","collapse":false},{"id":"f0628843.17a088","type":"ui_tab","name":"Geyser 1","icon":"fa-shower","order":1,"disabled":false,"hidden":false},{"id":"3dbab8ea.80bc68","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"GeyserWorx Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"true","allowTempTheme":"true","dateFormat":"YYYY/MM/DD","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"8c690c19.c1fce","type":"ui_group","name":"Charts","tab":"f0628843.17a088","order":2,"disp":false,"width":"20","collapse":false},{"id":"9a9a4f5d.b30e5","type":"ui_group","name":"Configuration","tab":"337d2a55.f14e56","order":1,"disp":false,"width":"4","collapse":false},{"id":"525bfa1b.1d4314","type":"ui_group","name":"Timers","tab":"f0628843.17a088","order":4,"disp":false,"width":"9","collapse":false},{"id":"6e17f487.cc820c","type":"ui_spacer","name":"spacer","group":"525bfa1b.1d4314","order":5,"width":1,"height":1},{"id":"115a813c.c8a16f","type":"ui_spacer","name":"spacer","group":"525bfa1b.1d4314","order":19,"width":1,"height":1},{"id":"df23ed40.fe2ac","type":"ui_spacer","name":"spacer","group":"525bfa1b.1d4314","order":33,"width":1,"height":1},{"id":"fab23069.9bc4","type":"ui_spacer","name":"spacer","group":"525bfa1b.1d4314","order":47,"width":1,"height":1},{"id":"f0ae256.27502d8","type":"ui_spacer","name":"spacer","group":"","order":2,"width":1,"height":1},{"id":"337d2a55.f14e56","type":"ui_tab","name":"Configuration","icon":"fa-cog","order":3,"disabled":false,"hidden":false},{"id":"efe91aea.44c2b8","type":"ui_group","name":"System Time","tab":"337d2a55.f14e56","order":2,"disp":false,"width":"6","collapse":false},{"id":"d257494b.692218","type":"ui_tab","name":"Geyser 2","icon":"fa-shower","order":2,"disabled":false,"hidden":false},{"id":"f9e4a7e3.f06e58","type":"ui_group","name":"Dashboard2","tab":"d257494b.692218","order":1,"disp":false,"width":"6","collapse":false},{"id":"8658851b.0540b8","type":"ui_group","name":"Charts","tab":"d257494b.692218","order":2,"disp":false,"width":"20","collapse":false},{"id":"3eed1d59.f985d2","type":"ui_group","name":"Timers","tab":"d257494b.692218","order":4,"disp":false,"width":"9","collapse":false},{"id":"5d84bd66.ced214","type":"ui_spacer","name":"spacer","group":"f9e4a7e3.f06e58","order":13,"width":1,"height":1},{"id":"159174d1.f8dceb","type":"ui_spacer","name":"spacer","group":"f9e4a7e3.f06e58","order":14,"width":1,"height":1},{"id":"eabdb59c.1a9298","type":"ui_spacer","name":"spacer","group":"f9e4a7e3.f06e58","order":15,"width":1,"height":1},{"id":"9fa62b71.fd9f38","type":"ui_spacer","name":"spacer","group":"f9e4a7e3.f06e58","order":16,"width":1,"height":1},{"id":"5aa5fa60.221634","type":"ui_spacer","name":"spacer","group":"f9e4a7e3.f06e58","order":17,"width":1,"height":1},{"id":"d80b9e3a.384f6","type":"ui_spacer","name":"spacer","group":"f9e4a7e3.f06e58","order":18,"width":1,"height":1},{"id":"a10e2447.9ef458","type":"ui_spacer","name":"spacer","group":"","order":2,"width":1,"height":1},{"id":"ccd05b6b.deeb18","type":"ui_spacer","name":"spacer","group":"3eed1d59.f985d2","order":5,"width":1,"height":1},{"id":"43d0625c.d886ec","type":"ui_spacer","name":"spacer","group":"3eed1d59.f985d2","order":19,"width":1,"height":1},{"id":"1ea52d24.2c01d3","type":"ui_spacer","name":"spacer","group":"3eed1d59.f985d2","order":33,"width":1,"height":1},{"id":"33e58cdd.edf4a4","type":"ui_spacer","name":"spacer","group":"3eed1d59.f985d2","order":47,"width":1,"height":1},{"id":"cdc76a83.f7bb88","type":"mqtt-broker","name":"MQTT","broker":"samworx.dedicated.co.za","port":"1883","clientid":"","usetls":false,"protocolVersion":"3","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"a8857356.d49e68","type":"csv","z":"c8c78f4d.679e8","name":"","sep":",","hdrin":false,"hdrout":"","multi":"one","ret":"\\n","temp":"","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":210,"y":80,"wires":[["d12b5d18.58218"]]},{"id":"3b501c89.fa554c","type":"split","z":"c8c78f4d.679e8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"topic","x":550,"y":80,"wires":[["6dad6ed9.c91f08"]]},{"id":"6dad6ed9.c91f08","type":"function","z":"c8c78f4d.679e8","name":"","func":"if (!context.results) context.results = {}\n\nif (!context.results[msg.topic]) context.results[msg.topic] = []\ncontext.results[msg.topic].push(msg.payload)\nmsg.payload = context.results\n\nif ((msg.originalParts.index === msg.originalParts.count - 1) && (msg.parts.index === msg.parts.count - 1)) {\n    msg.payload = context.results\n    context.results = {}\n    return msg\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":80,"wires":[["d71e0bef.46647"]]},{"id":"d12b5d18.58218","type":"change","z":"c8c78f4d.679e8","name":"","rules":[{"t":"set","p":"originalParts","pt":"msg","to":"parts","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":80,"wires":[["3b501c89.fa554c"]]},{"id":"d71e0bef.46647","type":"change","z":"c8c78f4d.679e8","name":"spread","rules":[{"t":"set","p":"payload","pt":"msg","to":"$spread(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":80,"wires":[[]]},{"id":"c0cc8db.196a17","type":"inject","z":"3dddaeea.f4e652","name":"Update","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":280,"wires":[["90426d21.09074"]]},{"id":"90426d21.09074","type":"function","z":"3dddaeea.f4e652","name":"Power Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/a\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":300,"wires":[["be6ce211.e3cd7"]]},{"id":"9e4ecc6c.fe2c7","type":"function","z":"3dddaeea.f4e652","name":"Analogue Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/A\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":340,"wires":[["be6ce211.e3cd7"]]},{"id":"9b44cde8.096a5","type":"function","z":"3dddaeea.f4e652","name":"Status Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/STS\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":380,"wires":[["be6ce211.e3cd7"]]},{"id":"4bc67a9e.4d2ce4","type":"function","z":"3dddaeea.f4e652","name":"Settings Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/SET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":420,"wires":[["be6ce211.e3cd7"]]},{"id":"c8c97430.ce8cb8","type":"function","z":"3dddaeea.f4e652","name":"System Time","func":"msg.data = global.get(\"unit\");\nmsg.topic = \"GWA/\"+msg.data+\"/S/Time/G\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":260,"wires":[["be6ce211.e3cd7","21ed096a.e7f606"]]},{"id":"9277515.474c9b","type":"function","z":"3dddaeea.f4e652","name":"Timer 1","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/Time/1\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":500,"wires":[["57658c95.7efe04"]]},{"id":"417e23a1.88676c","type":"complete","z":"3dddaeea.f4e652","name":"Power Complete","scope":["90426d21.09074"],"uncaught":false,"x":120,"y":340,"wires":[["9e4ecc6c.fe2c7"]]},{"id":"59a96a8b.521154","type":"complete","z":"3dddaeea.f4e652","name":"Analog Complete","scope":["9e4ecc6c.fe2c7"],"uncaught":false,"x":120,"y":380,"wires":[["9b44cde8.096a5"]]},{"id":"39b95243.a274ce","type":"complete","z":"3dddaeea.f4e652","name":"Status Complete","scope":["9b44cde8.096a5"],"uncaught":false,"x":120,"y":420,"wires":[["4bc67a9e.4d2ce4"]]},{"id":"acd27697.bbe018","type":"function","z":"ebe4365e.c94b18","name":"Gauge","func":"var payload = msg.data;\nvar temperature;    // 0-100\nvar setpoint;       // 0-100\nvar gwState;        // \"heating\", \"cooling\"\nvar leaf;\nvar away = flow.get(\"enabled1\") || 0;\nvar _output = {};\n\n\nif(payload.Status.O.PV===1){gwState = \"cooling\";}\nif(payload.Status.O.AC===1){gwState = \"heating\";}\nif(payload.Status.O.PV===0 && payload.Status.O.AC===0){gwState = \"off\";}\n\ntemperature = parseInt(payload.Analog.T.G);\nif (gwState == \"heating\")\n{\n    setpoint = parseInt(payload.Settings.S.ACT);\n}\nelse if(gwState == \"cooling\")\n{\n    setpoint = parseInt(payload.Settings.S.PVT);\n}\n\nleaf = 0;\n//away = 0;   // holiday mode\n\nvar output\t= [];\n\n    _output = {\n        \"payload\": {\n\t\t\t\t    \"temperature\":setpoint,\n\t\t\t\t    \"setpoint\":temperature,\n\t\t\t\t    \"state\":gwState,\n\t\t\t\t    \"leaf\":leaf,\n\t\t\t\t    \"away\":away\n        }\n    };\n\noutput = [\n\t\t\t_output\n\t\t];\n\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":320,"wires":[[]]},{"id":"1fd0e69c.ec9b69","type":"function","z":"ebe4365e.c94b18","name":"Heading","func":"msg.payload=1\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":40,"wires":[[]]},{"id":"12b01944.52f177","type":"function","z":"ebe4365e.c94b18","name":"AC_kW","func":"var kWh = msg.data.Power.I.AC/1000;\nmsg.text = \"AC: <b>\"+kWh.toFixed(0)+\"</b> kWh\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":360,"wires":[[]]},{"id":"28f0c64b.f78d7a","type":"function","z":"ebe4365e.c94b18","name":"","func":"msg.unit = 1;\nmsg.data = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":220,"y":40,"wires":[["1fd0e69c.ec9b69","acd27697.bbe018","12b01944.52f177","fbe53d83.501a","fe97ea5b.065858","1c8ff834.ddcad8","85f91d5.8785ce","78cd83e0.e4efcc","7f58b412.8b026c","29d6985d.5d8258","d87d151e.0da718","136a01c6.707ebe","a0bd42d7.b3a9c","2b040132.7b33be","a6b2625a.70167","807ff01c.132b1","bb87cf3a.d914a","10f4fc57.08c844","58bab2d0.f4cfdc","6aeddd83.d288c4","5a71b241.76eb4c"]]},{"id":"fbe53d83.501a","type":"function","z":"ebe4365e.c94b18","name":"PV_kW","func":"var kWh = msg.data.Power.I.PV/1000;\nmsg.text = \"PV: <b>\"+kWh.toFixed(0)+\"</b> kWh\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":400,"wires":[[]]},{"id":"fe97ea5b.065858","type":"function","z":"ebe4365e.c94b18","name":"ACCost","func":"var payload = msg.data.Power.I.AC/100;\nvar cost = msg.cost * payload;\nmsg.text = \"AC cost: <b>R \"+cost.toFixed(2)+\"</b>\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":440,"wires":[[]]},{"id":"1c8ff834.ddcad8","type":"function","z":"ebe4365e.c94b18","name":"PVCost","func":"var payload = msg.data.Power.I.PV/1000;\nvar cost = msg.cost * payload;\nmsg.text = \"PV cost: <b>R \"+cost.toFixed(2)+\"</b>\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":480,"wires":[[]]},{"id":"85f91d5.8785ce","type":"function","z":"ebe4365e.c94b18","name":"PVUsage","func":"var PV = (msg.data.Power.I.PV/(msg.data.Power.I.PV+msg.data.Power.I.AC))*100;\nmsg.text = \"PV usage: <b>\"+PV.toFixed(0)+\" </b>%\";\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":520,"wires":[[]]},{"id":"78cd83e0.e4efcc","type":"function","z":"ebe4365e.c94b18","name":"Carbon","func":"var payload = (parseFloat(msg.data.Power.I.PV)*0.7)/1000;\nmsg.text = \"CO2: <b>\"+payload.toFixed(2)+\"</b> tCO2e\";\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":560,"wires":[[]]},{"id":"7f58b412.8b026c","type":"function","z":"ebe4365e.c94b18","name":"Alarms","func":"var payload = msg.data;\nvar alarms;\nvar color = 0;\n\nif(msg.data.Status.A.Tr_Th==1 || msg.data.Status.A.Tr_Te==1 || msg.data.Status.A.Tr_DR==1 || msg.data.Status.A.Tr_CS==1 || msg.data.Status.A.Tr_PCB==1 || msg.data.Status.A.A_Sc==1 || msg.data.Status.A.A_An==1 || msg.data.Status.A.A_DT==1)\n{\n    if(msg.data.Status.A.Tr_Th==1){alarms=\"Over Temperature\"}\n    if(msg.data.Status.A.Tr_Te==1){alarms=\"Low Temperature\"}\n    if(msg.data.Status.A.Tr_DR==1){alarms=\"Dry Burn Alarm\"}\n    if(msg.data.Status.A.Tr_CS==1){alarms=\"Contactor Fault\"}\n    if(msg.data.Status.A.Tr_PCB==1){alarms=\"PCB Temperature Hi\"}\n    if(msg.data.Status.A.A_Sc==1){alarms=\"Scale Build-up\"}\n    if(msg.data.Status.A.A_An==1){alarms=\"Anode Depletion Alarm\"}\n    if(msg.data.Status.A.A_DT==1){alarms=\"Driptray Water Alarm\"}\n    color=1;\n}\nelse\n{\n    if(msg.data.Status.O.AC==1)\n    {\n        if(msg.data.Status.T == 1)\n        {\n            alarms = \"Timer Active\";\n        }\n        else\n        {\n            if(msg.data.Settings.O.ACO==1)\n            {\n                alarms = \"AC Boost Active\";\n            }\n            else\n            {\n                alarms = \"Heating from AC\";\n            }\n        }\n    }\n    else\n    {\n        alarms = \"Heating from PV\";\n    }\n}\n\nmsg.text = \"Status: <b>\"+alarms+\"</b>\";\nmsg.payload = color;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":600,"wires":[[]]},{"id":"29d6985d.5d8258","type":"function","z":"ebe4365e.c94b18","name":"AC On","func":"var payload = msg.data;\nif(payload.Settings.O.ACM===0)\n{\n    msg.topic = \"AC:Off\"\n    msg.text = msg.topic;\n}\nelse\n{\n    msg.topic = \"AC:On\"\n    msg.text = msg.topic;\n}\nmsg.payload = payload.Settings.O.ACM;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":80,"wires":[[]]},{"id":"d87d151e.0da718","type":"function","z":"ebe4365e.c94b18","name":"PV On","func":"var payload = msg.data;\nif(payload.Settings.O.PVM===0)\n{\n    msg.topic = \"PV:Off\"\n    msg.text = msg.topic;\n}\nelse\n{\n    msg.topic = \"PV:On\"\n    msg.text = msg.topic;\n}\nmsg.payload = payload.Settings.O.PVM;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":120,"wires":[[]]},{"id":"136a01c6.707ebe","type":"function","z":"ebe4365e.c94b18","name":"Boost On","func":"var payload = msg.data;\nif(payload.Settings.O.ACO===0)\n{\n    msg.topic = \"Boost\"\n    msg.text = msg.topic;\n}\nelse\n{\n    msg.topic = \"Boost\"\n    msg.text = msg.topic;\n}\nmsg.payload = payload.Settings.O.ACO;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":440,"y":160,"wires":[[]]},{"id":"a0bd42d7.b3a9c","type":"function","z":"ebe4365e.c94b18","name":"AC Setpoint","func":"var payload = msg.data;\nmsg.topic       = \"AC: \"+payload.Settings.S.ACT;\nmsg.payload     = payload.Settings.S.ACT;\nmsg.background  = payload.Settings.S.ACT == 1 ? \"DeepSkyBlue\" : \"grey\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":450,"y":200,"wires":[[]]},{"id":"2b040132.7b33be","type":"function","z":"ebe4365e.c94b18","name":"Boost Setpoint","func":"var payload = msg.data;\nmsg.topic       = \"Boost: \"+payload.Settings.S.ACOT;\nmsg.payload     = payload.Settings.S.ACOT;\nmsg.background  = payload.Settings.S.ACOT == 1 ? \"DeepSkyBlue\" : \"grey\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":240,"wires":[[]]},{"id":"a6b2625a.70167","type":"function","z":"ebe4365e.c94b18","name":"PV Setpoint","func":"var payload = msg.data;\nmsg.topic       = \"PV: \"+payload.Settings.S.PVT;\nmsg.payload     = payload.Settings.S.PVT;\nmsg.background  = payload.Settings.S.PVT == 1 ? \"DeepSkyBlue\" : \"grey\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":450,"y":280,"wires":[[]]},{"id":"807ff01c.132b1","type":"function","z":"ebe4365e.c94b18","name":"AC Current","func":"var I = msg.data.Analog.I.AC;\n\nmsg.text = \"AC: <b>\"+I.toFixed(2)+\"</b> A\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":640,"wires":[[]]},{"id":"bb87cf3a.d914a","type":"function","z":"ebe4365e.c94b18","name":"PV Current","func":"var I = msg.data.Analog.I.PV;\nmsg.text = \"PV: <b>\"+I.toFixed(2)+\"</b> A\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":680,"wires":[[]]},{"id":"10f4fc57.08c844","type":"function","z":"ebe4365e.c94b18","name":"PCB Temperature","func":"var I = msg.data.Analog.T.PCB;\nmsg.text = \"PCB: <b>\"+I.toFixed(0)+\"</b>\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":720,"wires":[[]]},{"id":"6aeddd83.d288c4","type":"function","z":"ebe4365e.c94b18","name":"PV Enable","func":"msg.payload = msg.data.Settings.O.PVM;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":840,"wires":[[]]},{"id":"5a71b241.76eb4c","type":"function","z":"ebe4365e.c94b18","name":"AC Boost","func":"msg.payload = msg.data.Settings.O.ACO;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":800,"wires":[[]]},{"id":"58bab2d0.f4cfdc","type":"function","z":"ebe4365e.c94b18","name":"AC Enable","func":"msg.payload = msg.data.Settings.O.ACM;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":760,"wires":[[]]},{"id":"5c6484be.02a62c","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"Dial","order":12,"width":"4","height":"4","format":"<div id=\"thermostat\"></div>\n\n<style>\n@import url(http://fonts.googleapis.com/css?family=Open+Sans:300);\n#thermostat {\n  margin: 0 auto;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n.dial {\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.dial.away .dial__ico__leaf {\n  visibility: hidden;\n}\n.dial.away .dial__lbl--target {\n  visibility: hidden;\n}\n.dial.away .dial__lbl--target--half {\n  visibility: hidden;\n}\n.dial.away .dial__lbl--away {\n  opacity: 1;\n}\n.dial .dial__shape {\n  -webkit-transition: fill 0.5s;\n  transition: fill 0.5s;\n}\n.dial__ico__leaf {\n  fill: #13EB13;\n  opacity: 0;\n  -webkit-transition: opacity 0.5s;\n  transition: opacity 0.5s;\n  pointer-events: none;\n}\n.dial.has-leaf .dial__ico__leaf {\n  display: block;\n  opacity: 1;\n  pointer-events: initial;\n}\n.dial__editableIndicator {\n  fill: white;\n  fill-rule: evenodd;\n  opacity: 0;\n  -webkit-transition: opacity 0.5s;\n  transition: opacity 0.5s;\n}\n.dial--edit .dial__editableIndicator {\n  opacity: 1;\n}\n.dial--state--off .dial__shape {\n  fill: #3d3c3c;\n}\n.dial--state--heating .dial__shape {\n  fill: #E36304;\n}\n.dial--state--cooling .dial__shape {\n  fill: #3c9517;\n}\n.dial__ticks path {\n  fill: rgba(255, 255, 255, 0.3);\n}\n.dial__ticks path.active {\n  fill: rgba(255, 255, 255, 0.8);\n}\n.dial text {\n  fill: white;\n  text-anchor: middle;\n  font-family: Helvetica, sans-serif;\n  alignment-baseline: central;\n}\n.dial__lbl--target {\n  font-size: 120px;\n  font-weight: bold;\n}\n.dial__lbl--target--half {\n  font-size: 40px;\n  font-weight: bold;\n  opacity: 0;\n  -webkit-transition: opacity 0.1s;\n  transition: opacity 0.1s;\n}\n.dial__lbl--target--half.shown {\n  opacity: 1;\n  -webkit-transition: opacity 0s;\n  transition: opacity 0s;\n}\n.dial__lbl--ambient {\n  font-size: 22px;\n  font-weight: bold;\n}\n.dial__lbl--away {\n  font-size: 72px;\n  font-weight: bold;\n  opacity: 0;\n  pointer-events: none;\n}\n#controls {\n  font-family: Open Sans;\n  background-color: rgba(255, 255, 255, 0.25);\n  padding: 20px;\n  border-radius: 5px;\n  position: absolute;\n  left: 50%;\n  -webkit-transform: translatex(-50%);\n          transform: translatex(-50%);\n  margin-top: 20px;\n}\n#controls label {\n  text-align: left;\n  display: block;\n}\n#controls label span {\n  display: inline-block;\n  width: 200px;\n  text-align: right;\n  font-size: 0.8em;\n  text-transform: uppercase;\n}\n#controls p {\n  margin: 0;\n  margin-bottom: 1em;\n  padding-bottom: 1em;\n  border-bottom: 2px solid #ccc;\n}\n</style>\n<script>\n    var thermostatDial = (function() {\n\t\n\t/*\n\t * Utility functions\n\t */\n\t\n\t// Create an element with proper SVG namespace, optionally setting its attributes and appending it to another element\n\tfunction createSVGElement(tag,attributes,appendTo) {\n\t\tvar element = document.createElementNS('http://www.w3.org/2000/svg',tag);\n\t\tattr(element,attributes);\n\t\tif (appendTo) {\n\t\t\tappendTo.appendChild(element);\n\t\t}\n\t\treturn element;\n\t}\n\t\n\t// Set attributes for an element\n\tfunction attr(element,attrs) {\n\t\tfor (var i in attrs) {\n\t\t\telement.setAttribute(i,attrs[i]);\n\t\t}\n\t}\n\t\n\t// Rotate a cartesian point about given origin by X degrees\n\tfunction rotatePoint(point, angle, origin) {\n\t\tvar radians = angle * Math.PI/180;\n\t\tvar x = point[0]-origin[0];\n\t\tvar y = point[1]-origin[1];\n\t\tvar x1 = x*Math.cos(radians) - y*Math.sin(radians) + origin[0];\n\t\tvar y1 = x*Math.sin(radians) + y*Math.cos(radians) + origin[1];\n\t\treturn [x1,y1];\n\t}\n\t\n\t// Rotate an array of cartesian points about a given origin by X degrees\n\tfunction rotatePoints(points, angle, origin) {\n\t\treturn points.map(function(point) {\n\t\t\treturn rotatePoint(point, angle, origin);\n\t\t});\n\t}\n\t\n\t// Given an array of points, return an SVG path string representing the shape they define\n\tfunction pointsToPath(points) {\n\t\treturn points.map(function(point, iPoint) {\n\t\t\treturn (iPoint>0?'L':'M') + point[0] + ' ' + point[1];\n\t\t}).join(' ')+'Z';\n\t}\n\t\n\tfunction circleToPath(cx, cy, r) {\n\t\treturn [\n\t\t\t\"M\",cx,\",\",cy,\n\t\t\t\"m\",0-r,\",\",0,\n\t\t\t\"a\",r,\",\",r,0,1,\",\",0,r*2,\",\",0,\n\t\t\t\"a\",r,\",\",r,0,1,\",\",0,0-r*2,\",\",0,\n\t\t\t\"z\"\n\t\t].join(' ').replace(/\\s,\\s/g,\",\");\n\t}\n\t\n\tfunction donutPath(cx,cy,rOuter,rInner) {\n\t\treturn circleToPath(cx,cy,rOuter) + \" \" + circleToPath(cx,cy,rInner);\n\t}\n\t\n\t// Restrict a number to a min + max range\n\tfunction restrictToRange(val,min,max) {\n\t\tif (val < min) return min;\n\t\tif (val > max) return max;\n\t\treturn val;\n\t}\n\t\n\t// Round a number to the nearest 0.5\n\tfunction roundHalf(num) {\n\t\treturn Math.round(num*2)/2;\n\t}\n\t\n\tfunction setClass(el, className, state) {\n\t\tel.classList[state ? 'add' : 'remove'](className);\n\t}\n\t\n\t/*\n\t * The \"MEAT\"\n\t */\n\n\treturn function(targetElement, options) {\n\t\tvar self = this;\n\t\t\n\t\t/*\n\t\t * Options\n\t\t */\n\t\toptions = options || {};\n\t\toptions = {\n\t\t\tdiameter: options.diameter || 400,\n\t\t\tminValue: options.minValue || 00, // Minimum value for target temperature\n\t\t\tmaxValue: options.maxValue || 85, // Maximum value for target temperature\n\t\t\tnumTicks: options.numTicks || 200, // Number of tick lines to display around the dial\n\t\t\tonSetTargetTemperature: options.onSetTargetTemperature || function() {}, // Function called when new target temperature set by the dial\n\t\t};\n\t\t\n\t\t/*\n\t\t * Properties - calculated from options in many cases\n\t\t */\n\t\tvar properties = {\n\t\t\ttickDegrees: 300, //  Degrees of the dial that should be covered in tick lines\n\t\t\trangeValue: options.maxValue - options.minValue,\n\t\t\tradius: options.diameter/2,\n\t\t\tticksOuterRadius: options.diameter / 30,\n\t\t\tticksInnerRadius: options.diameter / 8,\n\t\t\thvac_states: ['off', 'heating', 'cooling'],\n\t\t\tdragLockAxisDistance: 15,\n\t\t}\n\t\tproperties.lblAmbientPosition = [properties.radius, properties.ticksOuterRadius-(properties.ticksOuterRadius-properties.ticksInnerRadius)/2]\n\t\tproperties.offsetDegrees = 180-(360-properties.tickDegrees)/2;\n\t\t\n\t\t/*\n\t\t * Object state\n\t\t */\n\t\tvar state = {\n\t\t\ttarget_temperature: options.minValue,\n\t\t\tambient_temperature: options.minValue,\n\t\t\thvac_state: properties.hvac_states[0],\n\t\t\thas_leaf: false,\n\t\t\taway: false\n\t\t};\n\t\t\n\t\t/*\n\t\t * Property getter / setters\n\t\t */\n\t\tObject.defineProperty(this,'target_temperature',{\n\t\t\tget: function() {\n\t\t\t\treturn state.target_temperature;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.target_temperature = restrictTargetTemperature(+val);\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'ambient_temperature',{\n\t\t\tget: function() {\n\t\t\t\treturn state.ambient_temperature;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.ambient_temperature = roundHalf(+val);\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'hvac_state',{\n\t\t\tget: function() {\n\t\t\t\treturn state.hvac_state;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tif (properties.hvac_states.indexOf(val)>=0) {\n\t\t\t\t\tstate.hvac_state = val;\n\t\t\t\t\trender();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'has_leaf',{\n\t\t\tget: function() {\n\t\t\t\treturn state.has_leaf;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.has_leaf = !!val;\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'away',{\n\t\t\tget: function() {\n\t\t\t\treturn state.away;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.away = !!val;\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\t\n\t\t/*\n\t\t * SVG\n\t\t */\n\t\tvar svg = createSVGElement('svg',{\n\t\t\twidth: '100%', //options.diameter+'px',\n\t\t\theight: '100%', //options.diameter+'px',\n\t\t\tviewBox: '0 0 '+options.diameter+' '+options.diameter,\n\t\t\tclass: 'dial'\n\t\t},targetElement);\n\t\t// CIRCULAR DIAL\n\t\tvar circle = createSVGElement('circle',{\n\t\t\tcx: properties.radius,\n\t\t\tcy: properties.radius,\n\t\t\tr: properties.radius,\n\t\t\tclass: 'dial__shape'\n\t\t},svg);\n\t\t// EDITABLE INDICATOR\n\t\tvar editCircle = createSVGElement('path',{\n\t\t\td: donutPath(properties.radius,properties.radius,properties.radius-4,properties.radius-8),\n\t\t\tclass: 'dial__editableIndicator',\n\t\t},svg);\n\t\t\n\t\t/*\n\t\t * Ticks\n\t\t */\n\t\tvar ticks = createSVGElement('g',{\n\t\t\tclass: 'dial__ticks'\t\n\t\t},svg);\n\t\tvar tickPoints = [\n\t\t\t[properties.radius-1, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1, properties.ticksInnerRadius],\n\t\t\t[properties.radius-1, properties.ticksInnerRadius]\n\t\t];\n\t\tvar tickPointsLarge = [\n\t\t\t[properties.radius-1.5, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1.5, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1.5, properties.ticksInnerRadius+20],\n\t\t\t[properties.radius-1.5, properties.ticksInnerRadius+20]\n\t\t];\n\t\tvar theta = properties.tickDegrees/options.numTicks;\n\t\tvar tickArray = [];\n\t\tfor (var iTick=0; iTick<options.numTicks; iTick++) {\n\t\t\ttickArray.push(createSVGElement('path',{d:pointsToPath(tickPoints)},ticks));\n\t\t};\n\t\t\n\t\t/*\n\t\t * Labels\n\t\t */\n\t\tvar lblTarget = createSVGElement('text',{\n\t\t\tx: properties.radius,\n\t\t\ty: properties.radius,\n\t\t\tclass: 'dial__lbl dial__lbl--target'\n\t\t},svg);\n\t\tvar lblTarget_text = document.createTextNode('');\n\t\tlblTarget.appendChild(lblTarget_text);\n\t\t//\n\t\tvar lblTargetHalf = createSVGElement('text',{\n\t\t\tx: properties.radius + properties.radius/2.5,\n\t\t\ty: properties.radius - properties.radius/8,\n\t\t\tclass: 'dial__lbl dial__lbl--target--half'\n\t\t},svg);\n\t\tvar lblTargetHalf_text = document.createTextNode('5');\n\t\tlblTargetHalf.appendChild(lblTargetHalf_text);\n\t\t//\n\t\tvar lblAmbient = createSVGElement('text',{\n\t\t\tclass: 'dial__lbl dial__lbl--ambient'\n\t\t},svg);\n\t\tvar lblAmbient_text = document.createTextNode('');\n\t\tlblAmbient.appendChild(lblAmbient_text);\n\t\t//\n\t\tvar lblAway = createSVGElement('text',{\n\t\t\tx: properties.radius,\n\t\t\ty: properties.radius,\n\t\t\tclass: 'dial__lbl dial__lbl--away'\n\t\t},svg);\n\t\tvar lblAway_text = document.createTextNode('AWAY');\n\t\tlblAway.appendChild(lblAway_text);\n\t\t//\n\t\tvar icoLeaf = createSVGElement('path',{\n\t\t\tclass: 'dial__ico__leaf'\n\t\t},svg);\n\t\t\n\t\t/*\n\t\t * LEAF\n\t\t */\n\t\tvar leafScale = properties.radius/5/100;\n\t\tvar leafDef = [\"M\", 3, 84, \"c\", 24, 17, 51, 18, 73, -6, \"C\", 100, 52, 100, 22, 100, 4, \"c\", -13, 15, -37, 9, -70, 19, \"C\", 4, 32, 0, 63, 0, 76, \"c\", 6, -7, 18, -17, 33, -23, 24, -9, 34, -9, 48, -20, -9, 10, -20, 16, -43, 24, \"C\", 22, 63, 8, 78, 3, 84, \"z\"].map(function(x) {\n\t\t\treturn isNaN(x) ? x : x*leafScale;\n\t\t}).join(' ');\n\t\tvar translate = [properties.radius-(leafScale*100*0.5),properties.radius*1.5]\n\t\tvar icoLeaf = createSVGElement('path',{\n\t\t\tclass: 'dial__ico__leaf',\n\t\t\td: leafDef,\n\t\t\ttransform: 'translate('+translate[0]+','+translate[1]+')'\n\t\t},svg);\n\t\t\t\n\t\t/*\n\t\t * RENDER\n\t\t */\n\t\tfunction render() {\n\t\t\trenderAway();\n\t\t\trenderHvacState();\n\t\t\trenderTicks();\n\t\t\trenderTargetTemperature();\n\t\t\trenderAmbientTemperature();\n\t\t\trenderLeaf();\n\t\t}\n\t\trender();\n\n\t\t/*\n\t\t * RENDER - ticks\n\t\t */\n\t\tfunction renderTicks() {\n\t\t\tvar vMin, vMax;\n\t\t\tif (self.away) {\n\t\t\t\tvMin = self.ambient_temperature;\n\t\t\t\tvMax = vMin;\n\t\t\t} else {\n\t\t\t\tvMin = Math.min(self.ambient_temperature, self.target_temperature);\n\t\t\t\tvMax = Math.max(self.ambient_temperature, self.target_temperature);\n\t\t\t}\n\t\t\tvar min = restrictToRange(Math.round((vMin-options.minValue)/properties.rangeValue * options.numTicks),0,options.numTicks-1);\n\t\t\tvar max = restrictToRange(Math.round((vMax-options.minValue)/properties.rangeValue * options.numTicks),0,options.numTicks-1);\n\t\t\t//\n\t\t\ttickArray.forEach(function(tick,iTick) {\n\t\t\t\tvar isLarge = iTick==min || iTick==max;\n\t\t\t\tvar isActive = iTick >= min && iTick <= max;\n\t\t\t\tattr(tick,{\n\t\t\t\t\td: pointsToPath(rotatePoints(isLarge ? tickPointsLarge: tickPoints,iTick*theta-properties.offsetDegrees,[properties.radius, properties.radius])),\n\t\t\t\t\tclass: isActive ? 'active' : ''\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\n\t\t/*\n\t\t * RENDER - ambient temperature\n\t\t */\n\t\tfunction renderAmbientTemperature() {\n\t\t\tlblAmbient_text.nodeValue = Math.floor(self.ambient_temperature);\n\t\t\tif (self.ambient_temperature%1!=0) {\n\t\t\t\tlblAmbient_text.nodeValue += 'âµ';\n\t\t\t}\n\t\t\tvar peggedValue = restrictToRange(self.ambient_temperature, options.minValue, options.maxValue);\n\t\t\tdegs = properties.tickDegrees * (peggedValue-options.minValue)/properties.rangeValue - properties.offsetDegrees;\n\t\t\tif (peggedValue > self.target_temperature) {\n\t\t\t\tdegs += 8;\n\t\t\t} else {\n\t\t\t\tdegs -= 8;\n\t\t\t}\n\t\t\tvar pos = rotatePoint(properties.lblAmbientPosition,degs,[properties.radius, properties.radius]);\n\t\t\tattr(lblAmbient,{\n\t\t\t\tx: pos[0],\n\t\t\t\ty: pos[1]\n\t\t\t});\n\t\t}\n\n\t\t/*\n\t\t * RENDER - target temperature\n\t\t */\n\t\tfunction renderTargetTemperature() {\n\t\t\tlblTarget_text.nodeValue = Math.floor(self.target_temperature);\n\t\t\tsetClass(lblTargetHalf,'shown',self.target_temperature%1!=0);\n\t\t}\n\t\t\n\t\t/*\n\t\t * RENDER - leaf\n\t\t */\n\t\tfunction renderLeaf() {\n\t\t\tsetClass(svg,'has-leaf',self.has_leaf);\n\t\t}\n\t\t\n\t\t/*\n\t\t * RENDER - HVAC state\n\t\t */\n\t\tfunction renderHvacState() {\n\t\t\tArray.prototype.slice.call(svg.classList).forEach(function(c) {\n\t\t\t\tif (c.match(/^dial--state--/)) {\n\t\t\t\t\tsvg.classList.remove(c);\n\t\t\t\t};\n\t\t\t});\n\t\t\tsvg.classList.add('dial--state--'+self.hvac_state);\n\t\t}\n\t\t\n\t\t/*\n\t\t * RENDER - away\n\t\t */\n\t\tfunction renderAway() {\n\t\t\tsvg.classList[self.away ? 'add' : 'remove']('away');\n\t\t}\n\t\t\n\t\t/*\n\t\t * Drag to control\n\t\t */\n\t\tvar _drag = {\n\t\t\tinProgress: false,\n\t\t\tstartPoint: null,\n\t\t\tstartTemperature: 0,\n\t\t\tlockAxis: undefined\n\t\t};\n\t\t\n\t\tfunction eventPosition(ev) {\n\t\t\tif (ev.targetTouches && ev.targetTouches.length) {\n\t\t\t\treturn  [ev.targetTouches[0].clientX, ev.targetTouches[0].clientY];\n\t\t\t} else {\n\t\t\t\treturn [ev.x, ev.y];\n\t\t\t};\n\t\t}\n\t\t\n\t\tvar startDelay;\n\t\tfunction dragStart(ev) {\n\t\t\tstartDelay = setTimeout(function() {\n\t\t\t\tsetClass(svg, 'dial--edit', true);\n\t\t\t\t_drag.inProgress = true;\n\t\t\t\t_drag.startPoint = eventPosition(ev);\n\t\t\t\t_drag.startTemperature = self.ambient_temperature || options.minValue;\n\t\t\t\t_drag.lockAxis = undefined;\n\t\t\t},1000);\n\t\t};\n\t\t\n\t\tfunction dragEnd (ev) {\n\t\t\tclearTimeout(startDelay);\n\t\t\tsetClass(svg, 'dial--edit', false);\n\t\t\tif (!_drag.inProgress) return;\n\t\t\t_drag.inProgress = false;\n\t\t\tif (self.ambient_temperature != _drag.startTemperature) {\n\t\t\t\tif (typeof options.onSetTargetTemperature == 'function') {\n\t\t\t\t\toptions.onSetTargetTemperature(self.ambient_temperature);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\tfunction dragMove(ev) {\n\t\t\tev.preventDefault();\n\t\t\tif (!_drag.inProgress) return;\n\t\t\tvar evPos =  eventPosition(ev);\n\t\t\tvar dy = _drag.startPoint[1]-evPos[1];\n\t\t\tvar dx = evPos[0] - _drag.startPoint[0];\n\t\t\tvar dxy;\n\t\t\tif (_drag.lockAxis == 'x') {\n\t\t\t\tdxy  = dx;\n\t\t\t} else if (_drag.lockAxis == 'y') {\n\t\t\t\tdxy = dy;\n\t\t\t} else if (Math.abs(dy) > properties.dragLockAxisDistance) {\n\t\t\t\t_drag.lockAxis = 'y';\n\t\t\t\tdxy = dy;\n\t\t\t} else if (Math.abs(dx) > properties.dragLockAxisDistance) {\n\t\t\t\t_drag.lockAxis = 'x';\n\t\t\t\tdxy = dx;\n\t\t\t} else {\n\t\t\t\tdxy = (Math.abs(dy) > Math.abs(dx)) ? dy : dx;\n\t\t\t};\n\t\t\tvar dValue = (dxy*getSizeRatio())/(options.diameter)*properties.rangeValue;\n\t\t\tself.ambient_temperature = roundHalf(_drag.startTemperature+dValue);\n\t\t}\n\t\t\n\t\tsvg.addEventListener('mousedown',dragStart);\n\t\tsvg.addEventListener('touchstart',dragStart);\n\t\t\n\t\tsvg.addEventListener('mouseup',dragEnd);\n\t\tsvg.addEventListener('mouseleave',dragEnd);\n\t\tsvg.addEventListener('touchend',dragEnd);\n\t\t\n\t\tsvg.addEventListener('mousemove',dragMove);\n\t\tsvg.addEventListener('touchmove',dragMove);\n\t\t//\n\t\t\n\t\t/*\n\t\t * Helper functions\n\t\t */\n\t\tfunction restrictTargetTemperature(t) {\n\t\t\treturn restrictToRange(roundHalf(t),options.minValue,options.maxValue);\n\t\t}\n\t\t\n\t\tfunction angle(point) {\n\t\t\tvar dx = point[0] - properties.radius;\n\t\t\tvar dy = point[1] - properties.radius;\n\t\t\tvar theta = Math.atan(dx/dy) / (Math.PI/180);\n\t\t\tif (point[0]>=properties.radius && point[1] < properties.radius) {\n\t\t\t\ttheta = 90-theta - 90;\n\t\t\t} else if (point[0]>=properties.radius && point[1] >= properties.radius) {\n\t\t\t\ttheta = 90-theta + 90;\n\t\t\t} else if (point[0]<properties.radius && point[1] >= properties.radius) {\n\t\t\t\ttheta = 90-theta + 90;\n\t\t\t} else if (point[0]<properties.radius && point[1] < properties.radius) {\n\t\t\t\ttheta = 90-theta+270;\n\t\t\t}\n\t\t\treturn theta;\n\t\t};\n\t\t\n\t\tfunction getSizeRatio() {\n\t\t\treturn options.diameter / targetElement.clientWidth;\n\t\t}\n\t\t\n\t};\n})();\n\n/* ==== */\n(function(scope) {\n    \n    var nest = new thermostatDial(document.getElementById('thermostat'),{\n    \tonSetTargetTemperature: function(v) {\n    \t\tscope.send({topic: \"target_temperature\", payload: v});\n    \t}\n    });\n\n\n    scope.$watch('msg', function(data) {\n        //console.log(data.topic+\"  \"+data.payload);\n            nest.ambient_temperature = data.payload.temperature;\n            nest.target_temperature = data.payload.setpoint;\n            nest.hvac_state = data.payload.state;\n            nest.has_leaf = data.payload.leaf;\n            nest.away = data.payload.away;\n    });\n})(scope);\n\n</script>","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","x":530,"y":180,"wires":[[]]},{"id":"ed03a1d3.ce27e","type":"ui_text","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","order":11,"width":"1","height":"2","name":"Blank","label":"","format":"","layout":"row-spread","x":710,"y":60,"wires":[]},{"id":"d07520c2.54452","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"Title","order":1,"width":"6","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":40,"wires":[[]]},{"id":"56da94d8.013bfc","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"ACkWh","order":13,"width":"3","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #FFE082;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#FFE082'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":540,"y":200,"wires":[[]]},{"id":"b0a3266c.68ff48","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"PVkWh","order":14,"width":"3","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #C5E1A5;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#C5E1A5'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":540,"y":220,"wires":[[]]},{"id":"1d1715f7.c0919a","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"ACcost","order":15,"width":"3","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #FFE082;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#FFE082'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":540,"y":240,"wires":[[]]},{"id":"14539374.bb98cd","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"PVsave","order":16,"width":"3","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #C5E1A5;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#C5E1A5'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":540,"y":260,"wires":[[]]},{"id":"5339dab5.a77744","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"PV%","order":17,"width":"3","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":280,"wires":[[]]},{"id":"57e12621.beb758","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"CO2","order":18,"width":"3","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":300,"wires":[[]]},{"id":"f52c35e3.f469d8","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"Alarms","order":19,"width":"6","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? '#E65100' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":540,"y":320,"wires":[[]]},{"id":"80bfe287.5b677","type":"inject","z":"94e0adf3.31d6b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"0.3","topic":"","payload":"","payloadType":"date","x":100,"y":300,"wires":[["f87806a3.730a88"]]},{"id":"36dabf01.fa6c9","type":"ui_text_input","z":"94e0adf3.31d6b","name":"","label":"AC Setpoint","tooltip":"","group":"b0690eac.2cf5f","order":5,"width":"2","height":"1","passthru":false,"mode":"number","delay":"0","topic":"","x":550,"y":120,"wires":[["2681ca3.62c4f36"]]},{"id":"2574f69.623c50a","type":"ui_text_input","z":"94e0adf3.31d6b","name":"","label":"Boost Setpoint","tooltip":"","group":"b0690eac.2cf5f","order":7,"width":"2","height":"1","passthru":false,"mode":"number","delay":"0","topic":"","x":560,"y":140,"wires":[["7ecc56c9.3b0418"]]},{"id":"c3ba272.60550d8","type":"ui_text_input","z":"94e0adf3.31d6b","name":"","label":"PV Setpoint","tooltip":"","group":"b0690eac.2cf5f","order":6,"width":"2","height":"1","passthru":false,"mode":"number","delay":"0","topic":"","x":550,"y":160,"wires":[["b27d899e.017de8"]]},{"id":"764e94f0.ceaf1c","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"AC I","order":20,"width":"2","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":340,"wires":[[]]},{"id":"609a4636.7e00d8","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"PV I","order":21,"width":"2","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":360,"wires":[[]]},{"id":"f38f4fca.c39da","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"PCB","order":22,"width":"2","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? '#E65100' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":380,"wires":[[]]},{"id":"9920e014.d21fd","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"AC","order":2,"width":"2","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: white;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: grey;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : 'grey'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":60,"wires":[[]]},{"id":"c776db5b.eb0d08","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"PV","order":3,"width":"2","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: white;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: grey;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : 'grey'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":80,"wires":[[]]},{"id":"b474bbd4.90ea48","type":"ui_template","z":"94e0adf3.31d6b","group":"b0690eac.2cf5f","name":"Boost","order":4,"width":"2","height":"1","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: white;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: grey;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : 'grey'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":530,"y":100,"wires":[[]]},{"id":"1db928de.592ac7","type":"subflow:ebe4365e.c94b18","z":"94e0adf3.31d6b","name":"","env":[],"x":310,"y":240,"wires":[["d07520c2.54452"],["9920e014.d21fd"],["c776db5b.eb0d08"],["b474bbd4.90ea48"],["36dabf01.fa6c9"],["2574f69.623c50a"],["c3ba272.60550d8"],["5c6484be.02a62c"],["56da94d8.013bfc"],["b0a3266c.68ff48"],["1d1715f7.c0919a"],["14539374.bb98cd"],["5339dab5.a77744"],["57e12621.beb758"],["f52c35e3.f469d8"],["764e94f0.ceaf1c"],["609a4636.7e00d8"],["f38f4fca.c39da"],["90b5c4eb.587ac8"],["c9991542.e02d78"],["81f067b2.374508"]]},{"id":"f87806a3.730a88","type":"function","z":"94e0adf3.31d6b","name":"","func":"msg.payload = global.get(\"Geyser1Data\");\nmsg.cost = global.get(\"EskomRate\");\nmsg.text = global.get(\"Geyser1Name\");\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":140,"y":240,"wires":[["1db928de.592ac7","fbb57feb.81c8a"]]},{"id":"90b5c4eb.587ac8","type":"ui_switch","z":"94e0adf3.31d6b","name":"","label":"AC","tooltip":"Enable AC Usage","group":"b0690eac.2cf5f","order":8,"width":"2","height":"1","passthru":false,"decouple":"true","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square fa-2x","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o fa-2x","offcolor":"grey","animate":true,"x":530,"y":400,"wires":[["dbcf2f21.5acd4"]]},{"id":"c9991542.e02d78","type":"ui_switch","z":"94e0adf3.31d6b","name":"","label":"Boost","tooltip":"","group":"b0690eac.2cf5f","order":9,"width":"2","height":"1","passthru":false,"decouple":"true","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square fa-2x","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o fa-2x","offcolor":"grey","animate":true,"x":530,"y":420,"wires":[["dea92862.287de8"]]},{"id":"81f067b2.374508","type":"ui_switch","z":"94e0adf3.31d6b","name":"","label":"PV","tooltip":"","group":"b0690eac.2cf5f","order":10,"width":"2","height":"1","passthru":false,"decouple":"true","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square fa-2x","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o fa-2x","offcolor":"grey","animate":true,"x":530,"y":440,"wires":[["4ba20c9e.3c70a4"]]},{"id":"df6e7497.70f778","type":"ui_button","z":"94e0adf3.31d6b","name":"","group":"b0690eac.2cf5f","order":24,"width":"4","height":"1","passthru":false,"label":"Reset","tooltip":"","color":"","bgcolor":"grey","icon":"","payload":"","payloadType":"str","topic":"","x":530,"y":460,"wires":[["8e00c374.933db"]]},{"id":"d442b3d4.aa40d","type":"complete","z":"3dddaeea.f4e652","name":"Sequence Complete","scope":["4bc67a9e.4d2ce4"],"uncaught":false,"x":130,"y":460,"wires":[["ea87a6d4.893d28"]]},{"id":"ea87a6d4.893d28","type":"link out","z":"3dddaeea.f4e652","name":"HTTP Req Complete 1","links":["d3263605.ab9d18","dba7953d.de8d18"],"x":275,"y":460,"wires":[]},{"id":"dba7953d.de8d18","type":"link in","z":"94e0adf3.31d6b","name":"Dashboard Update","links":["ea87a6d4.893d28","3ce40ab3.4ceeb6"],"x":135,"y":340,"wires":[["f87806a3.730a88"]]},{"id":"908a70e6.73a6a","type":"ui_button","z":"94e0adf3.31d6b","name":"Refresh","group":"b0690eac.2cf5f","order":25,"width":"2","height":"1","passthru":false,"label":"","tooltip":"Refresh Data","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"topic","x":540,"y":480,"wires":[["ab2e9407.6b4978"]]},{"id":"ab2e9407.6b4978","type":"link out","z":"94e0adf3.31d6b","name":"Refresh","links":["80998976.fa4748","389492ec.81b43e"],"x":655,"y":480,"wires":[]},{"id":"80998976.fa4748","type":"link in","z":"3dddaeea.f4e652","name":"Refresh1","links":["ab2e9407.6b4978"],"x":175,"y":300,"wires":[["90426d21.09074"]]},{"id":"90089777.ef3758","type":"ui_chart","z":"94e0adf3.31d6b","name":"","group":"8c690c19.c1fce","order":0,"width":0,"height":0,"label":"Geyser Data","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"monotone","nodata":"","dot":false,"ymin":"0","ymax":"80","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":550,"y":580,"wires":[[]]},{"id":"298e3073.14be","type":"function","z":"94e0adf3.31d6b","name":"Temperature","func":"var data = global.get(\"Geyser1Data\");\nvar temp = parseFloat(data.Analog.T.G);\nmsg.payload = temp.toFixed(1);\nmsg.topic = \"Geyser Temperature\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":370,"y":560,"wires":[["90089777.ef3758"]]},{"id":"22683738.bb31b8","type":"function","z":"94e0adf3.31d6b","name":"PCB","func":"var data = global.get(\"Geyser1Data\");\nvar temp = parseFloat(data.Analog.T.PCB);\nmsg.payload = temp.toFixed(1);\nmsg.topic = \"PCB Temperature\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":580,"wires":[["90089777.ef3758"]]},{"id":"c2d4d6d0.301288","type":"inject","z":"5395d339.48846c","name":"Startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":120,"y":80,"wires":[["328ace3e.a7a0a2"]]},{"id":"328ace3e.a7a0a2","type":"function","z":"5395d339.48846c","name":"Settings","func":"msg.payload = {\n    \"IP\": global.get(\"IP\"),\n    \"SN\": global.get(\"unit\"),\n    \"Size\": global.get(\"size\"),\n    \"Rate\": global.get(\"EskomRate\"),\n    \"Dual\": global.get(\"Dual\"),\n    \"Geyser1Name\": global.get(\"Geyser1Name\"),\n    \"Geyser2Name\": global.get(\"Geyser2Name\")\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":300,"y":80,"wires":[["c9d048ea.e75198"]]},{"id":"dbcf2f21.5acd4","type":"function","z":"94e0adf3.31d6b","name":"AC On/Off","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"O\":{\n    \t\t\t\t    \"ACM\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/1/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nnode.status({text:msg.payload});\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":400,"wires":[["a34f4a30.383618"]]},{"id":"dea92862.287de8","type":"function","z":"94e0adf3.31d6b","name":"Boost On/Off","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"O\":{\n    \t\t\t\t    \"ACO\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/1/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":420,"wires":[["a34f4a30.383618"]]},{"id":"4ba20c9e.3c70a4","type":"function","z":"94e0adf3.31d6b","name":"PV On/Off","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"O\":{\n    \t\t\t\t    \"PVM\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/1/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":440,"wires":[["a34f4a30.383618"]]},{"id":"2681ca3.62c4f36","type":"function","z":"94e0adf3.31d6b","name":"ACT","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"S\":{\n    \t\t\t\t    \"ACT\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/1/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":120,"wires":[["a34f4a30.383618"]]},{"id":"7ecc56c9.3b0418","type":"function","z":"94e0adf3.31d6b","name":"ACOT","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"S\":{\n    \t\t\t\t    \"ACOT\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/1/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\n\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":140,"wires":[["a34f4a30.383618"]]},{"id":"b27d899e.017de8","type":"function","z":"94e0adf3.31d6b","name":"PVT","func":"var payload;\nvar output\t= [];\nif(msg.payload > 70)    // limit to 70\n{\n    payload = 70;\n}\nelse\n{\n    payload = msg.payload;\n}\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"S\":{\n    \t\t\t\t    \"PVT\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/1/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\n\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":160,"wires":[["a34f4a30.383618"]]},{"id":"8e00c374.933db","type":"function","z":"94e0adf3.31d6b","name":"Reset","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"A\":{\n    \t\t\t\t    \"Tr_DR\": \"\",\n    \t\t\t\t    \"A_Sc\": \"\",\n    \t\t\t\t    \"A_An\": \"\",\n    \t\t\t\t    \"A_DT\": \"\"\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/1/STS\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nnode.status({text:msg.payload});\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":460,"wires":[["a34f4a30.383618"]]},{"id":"c9d048ea.e75198","type":"ui_form","z":"5395d339.48846c","name":"","label":"","group":"9a9a4f5d.b30e5","order":3,"width":0,"height":0,"options":[{"label":"IP Address","value":"IP","type":"text","required":true,"rows":null},{"label":"Wifi Serial No","value":"SN","type":"text","required":true,"rows":null},{"label":"Element Size (kW)","value":"Size","type":"number","required":true,"rows":null},{"label":"Eskom Rate","value":"Rate","type":"number","required":true,"rows":null},{"label":"Geyser 1 Name","value":"Geyser1Name","type":"text","required":true,"rows":null},{"label":"Dual Unit","value":"Dual","type":"switch","required":false,"rows":null},{"label":"Geyser 2 Name","value":"Geyser2Name","type":"text","required":false,"rows":null}],"formValue":{"IP":"","SN":"","Size":"","Rate":"","Geyser1Name":"","Dual":false,"Geyser2Name":""},"payload":"","submit":"submit","cancel":"cancel","topic":"topic","topicType":"msg","splitLayout":"","x":470,"y":80,"wires":[["573a7432.aafeac","454f1f89.e341b"]]},{"id":"573a7432.aafeac","type":"function","z":"5395d339.48846c","name":"Settings","func":"global.set(\"unit\", msg.payload.SN);\nglobal.set(\"size\", msg.payload.Size);\nglobal.set(\"IP\", msg.payload.IP);\nglobal.set(\"EskomRate\", msg.payload.Rate);\nglobal.set(\"Dual\", msg.payload.Dual);\nglobal.set(\"Geyser1Name\", msg.payload.Geyser1Name);\nglobal.set(\"Geyser2Name\", msg.payload.Geyser2Name);\n//global.set(\"GeyserData\", {});\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":640,"y":80,"wires":[["d69e037.8af88"]]},{"id":"78564af6.253eb4","type":"inject","z":"94e0adf3.31d6b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":140,"y":560,"wires":[["298e3073.14be","22683738.bb31b8"]]},{"id":"ccddd605.0342a8","type":"ping","z":"5395d339.48846c","protocol":"IPv4","mode":"triggered","name":"","host":"","timer":"20","inputs":1,"x":290,"y":220,"wires":[["e503676f.3d0528"]]},{"id":"63c277e7.f38038","type":"inject","z":"5395d339.48846c","name":"","props":[{"p":"payload"}],"repeat":"600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"IP","payloadType":"global","x":120,"y":220,"wires":[["ccddd605.0342a8"]]},{"id":"e503676f.3d0528","type":"function","z":"5395d339.48846c","name":"","func":"if(msg.payload === false)\n{\n    msg.payload = 0;\n}\nelse\n{\n    msg.payload = 1;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":440,"y":220,"wires":[["178636d5.0afa29"]]},{"id":"178636d5.0afa29","type":"ui_switch","z":"5395d339.48846c","d":true,"name":"","label":"Online","tooltip":"GeyserWorx Connected","group":"9a9a4f5d.b30e5","order":2,"width":"0","height":"0","passthru":false,"decouple":"true","topic":"topic","topicType":"msg","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o fa-2x","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-window-close fa-2x","offcolor":"grey","animate":true,"x":610,"y":220,"wires":[[]]},{"id":"389492ec.81b43e","type":"link in","z":"5395d339.48846c","name":"OnlineCheck","links":["ab2e9407.6b4978"],"x":155,"y":260,"wires":[["54578fd.1c7537"]]},{"id":"54578fd.1c7537","type":"function","z":"5395d339.48846c","name":"","func":"msg.payload = global.get(\"IP\");\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":260,"wires":[["ccddd605.0342a8"]]},{"id":"e8da80c.f2e098","type":"ui_template","z":"5395d339.48846c","group":"9a9a4f5d.b30e5","name":"Group Title","order":1,"width":"0","height":"0","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        >Configuration\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":350,"y":40,"wires":[[]]},{"id":"4a204b0f.313564","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Enable","tooltip":"","group":"525bfa1b.1d4314","order":2,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"Enable","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":720,"y":300,"wires":[["f3b8dcbb.66503"]]},{"id":"30d3924e.a45efe","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Mo","tooltip":"Monday","group":"525bfa1b.1d4314","order":6,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"Monday","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":730,"y":320,"wires":[["f3b8dcbb.66503"]]},{"id":"41d4a877.0cc3d8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Tu","tooltip":"Tuesday","group":"525bfa1b.1d4314","order":7,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"Tuesday","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":730,"y":340,"wires":[["f3b8dcbb.66503"]]},{"id":"280e68b2.eac5c8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"We","tooltip":"Wednesday","group":"525bfa1b.1d4314","order":8,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"Wednesday","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":730,"y":360,"wires":[["f3b8dcbb.66503"]]},{"id":"bafc57a6.924aa8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Th","tooltip":"Thursday","group":"525bfa1b.1d4314","order":9,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"Thursday","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":730,"y":380,"wires":[["f3b8dcbb.66503"]]},{"id":"7d8565df.70a1cc","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Fr","tooltip":"Friday","group":"525bfa1b.1d4314","order":10,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"Friday","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":730,"y":400,"wires":[["f3b8dcbb.66503"]]},{"id":"1656fba3.48fdf4","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Sa","tooltip":"Saturday","group":"525bfa1b.1d4314","order":11,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"Saturday","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":730,"y":420,"wires":[["f3b8dcbb.66503"]]},{"id":"f5ae693d.05d6e8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Su","tooltip":"Sunday","group":"525bfa1b.1d4314","order":12,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"Sunday","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":730,"y":440,"wires":[["f3b8dcbb.66503"]]},{"id":"42ab1143.65392","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"On","tooltip":"On Time","group":"525bfa1b.1d4314","order":3,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"OnTime","topicType":"str","x":730,"y":460,"wires":[["f3b8dcbb.66503"]]},{"id":"817f4a6d.7353b8","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"Off","tooltip":"Off Time","group":"525bfa1b.1d4314","order":4,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"OffTime","topicType":"str","x":730,"y":480,"wires":[["f3b8dcbb.66503"]]},{"id":"63957b4d.d0d3e4","type":"ui_button","z":"90588a53.b682a8","name":"Save Data T1","group":"525bfa1b.1d4314","order":14,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":60,"wires":[["39ed0154.c1a1ce"]]},{"id":"39ed0154.c1a1ce","type":"function","z":"90588a53.b682a8","name":"","func":"var data = global.get(\"Geyser1Data\");\n\nmsg.payload = {\n    \"C\":data.Timer1.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer1.S.h),\n        \"m\": parseInt(data.Timer1.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer1.E.h),\n        \"m\": parseInt(data.Timer1.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer1.W.Mo,\n        \"Tu\": data.Timer1.W.Tu,\n        \"We\": data.Timer1.W.We,\n        \"Th\": data.Timer1.W.Th,\n        \"Fr\": data.Timer1.W.Fr,\n        \"Sa\": data.Timer1.W.Sa,\n        \"Su\": data.Timer1.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":60,"wires":[["7fd2879f.b008b8"]]},{"id":"86e28679.9788f8","type":"ui_button","z":"90588a53.b682a8","name":"Refresh","group":"525bfa1b.1d4314","order":13,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":360,"wires":[["d41c91f1.a0978","ba303cb1.ef8c2"]]},{"id":"a0e67d5a.7fb62","type":"comment","z":"90588a53.b682a8","name":"Timer 1","info":"","x":90,"y":320,"wires":[]},{"id":"d41c91f1.a0978","type":"link out","z":"90588a53.b682a8","name":"TimersRefresh","links":["2cb7eb09.2d32e4","7013cb5f.e39b24"],"x":295,"y":320,"wires":[]},{"id":"2cb7eb09.2d32e4","type":"link in","z":"3dddaeea.f4e652","name":"Timers 1 Data","links":["d41c91f1.a0978"],"x":175,"y":520,"wires":[["9277515.474c9b"]]},{"id":"fe3be814.873ea8","type":"inject","z":"90588a53.b682a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":400,"wires":[["ba303cb1.ef8c2"]]},{"id":"4971f5fd.409f9c","type":"inject","z":"3dddaeea.f4e652","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":110,"y":1700,"wires":[["f74f994d.ca7fa8"]]},{"id":"2e75980b.27e7d8","type":"csv","z":"3dddaeea.f4e652","name":"","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\r\\n","temp":"","skip":"0","strings":true,"include_empty_strings":true,"include_null_values":"","x":490,"y":1700,"wires":[["d0714d4.f98e3b"]]},{"id":"d0714d4.f98e3b","type":"file","z":"3dddaeea.f4e652","name":"","filename":"","appendNewline":false,"createDir":true,"overwriteFile":"false","encoding":"none","x":630,"y":1700,"wires":[["5ca84300.5916ec"]]},{"id":"5ca84300.5916ec","type":"debug","z":"3dddaeea.f4e652","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":790,"y":1700,"wires":[]},{"id":"f74f994d.ca7fa8","type":"function","z":"3dddaeea.f4e652","name":"CSV Format","func":"var payload = global.get(\"Geyser1Data\");\nvar d = new Date();\nvar ts = d.getTime();\nvar year = d.getFullYear();\nvar month = d.getMonth()+1;\nvar day = d.getDate();\nvar hour = d.getHours();\nvar minute = d.getMinutes();\nvar second = d.getSeconds();\n\nif(month.toString().length == 1)  { month = '0'+month;}\nif(day.toString().length == 1)    { day = '0'+day;}   \nif(hour.toString().length == 1)   { hour = '0'+hour;}\nif(minute.toString().length == 1) { minute = '0'+minute;}\nif(second.toString().length == 1) { second = '0'+second;}\n\n\nvar dateString = \"Data/G1_\"+year+month+day;\nmsg.filename = dateString+\".csv\";\n\nmsg.payload = {\n    \"TS\": ts,\n    \"T_G\": payload.Analog.T.G,\n    \"T_PCB\": payload.Analog.T.PCB,\n    \"I_AC\": payload.Analog.I.AC,\n    \"I_PV\": payload.Analog.I.PV,\n    \"P_AC\": payload.Power.I.AC,\n    \"P_PV\": payload.Power.I.PV,\n    \"Alarms\": \"A\"+payload.Status.A.Tr_Te + payload.Status.A.Tr_DR + payload.Status.A.Tr_CS + payload.Status.A.Tr_PCB + payload.Status.A.A_Sc + payload.Status.A.A_An + payload.Status.A.A_DT,\n    \"O_AC\": payload.Status.O.AC,\n    \"O_PV\": payload.Status.O.PV,\n    \"S_ACM\": payload.Settings.O.ACM,\n    \"S_ACO\": payload.Settings.O.ACO,\n    \"S_PVM\": payload.Settings.O.PVM,\n    \"S_ACT\": payload.Settings.S.ACT,\n    \"S_ACOT\": payload.Settings.S.ACOT,\n    \"S_PVT\": payload.Settings.S.PVT,\n    \"S_ACCT\": payload.Settings.S.ACCT\n};\nmsg.columns = \"TS,T_G,T_PCB,I_AC,I_PV,P_AC,P_PV,Alarms,O_AC,O_PV,S_ACM,S_ACO,S_PVM,S_ACT,S_ACOT,S_PVT,S_ACCT\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":1700,"wires":[["2e75980b.27e7d8"]]},{"id":"93981a71.6b8ff8","type":"debug","z":"3dddaeea.f4e652","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":2080,"wires":[]},{"id":"efef5d16.81e96","type":"inject","z":"3dddaeea.f4e652","name":"","props":[{"p":"payload","v":"","vt":"date"},{"p":"topic","v":"","vt":"string"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":2080,"wires":[["8128a8b4.1e0008"]]},{"id":"f331331e.9963c","type":"comment","z":"3dddaeea.f4e652","name":"Retrieve Data from File","info":"","x":140,"y":2040,"wires":[]},{"id":"6e89f6e5.40a378","type":"subflow:c8c78f4d.679e8","z":"3dddaeea.f4e652","name":"","env":[],"x":570,"y":2080,"wires":[["93981a71.6b8ff8"]]},{"id":"b66ea657.f5ec28","type":"file in","z":"3dddaeea.f4e652","name":"","filename":"","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":410,"y":2080,"wires":[["6e89f6e5.40a378"]]},{"id":"8128a8b4.1e0008","type":"function","z":"3dddaeea.f4e652","name":"Get Today","func":"var d = new Date();\nvar ts = d.getTime();\nvar year = d.getFullYear();\nvar month = d.getMonth()+1;\nvar day = d.getDate();\nvar hour = d.getHours();\nvar minute = d.getMinutes();\nvar second = d.getSeconds();\n\nif(month.toString().length == 1)  { month = '0'+month;}\nif(day.toString().length == 1)    { day = '0'+day;}   \nif(hour.toString().length == 1)   { hour = '0'+hour;}\nif(minute.toString().length == 1) { minute = '0'+minute;}\nif(second.toString().length == 1) { second = '0'+second;}\n\n\nvar dateString = \"Data/G1_\"+year+month+day;\nmsg.filename = dateString+\".csv\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":270,"y":2080,"wires":[["b66ea657.f5ec28"]]},{"id":"7bc3a099.8fa85","type":"comment","z":"3dddaeea.f4e652","name":"Save Data to File","info":"","x":120,"y":1660,"wires":[]},{"id":"b8253085.e4665","type":"comment","z":"3dddaeea.f4e652","name":"Save Daily power data","info":"","x":140,"y":1840,"wires":[]},{"id":"a989793.f234088","type":"inject","z":"3dddaeea.f4e652","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"55 23 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"Geyser1Data","payloadType":"global","x":160,"y":1880,"wires":[["428a5de1.2cbcf4"]]},{"id":"428a5de1.2cbcf4","type":"function","z":"3dddaeea.f4e652","name":"CSV Format","func":"var d = new Date();\nvar ts = d.getTime();\nvar year = d.getFullYear();\nvar month = d.getMonth()+1;\nvar day = d.getDate();\nvar hour = d.getHours();\nvar minute = d.getMinutes();\nvar second = d.getSeconds();\n\nif(month.toString().length == 1)  { month = '0'+month;}\nif(day.toString().length == 1)    { day = '0'+day;}   \nif(hour.toString().length == 1)   { hour = '0'+hour;}\nif(minute.toString().length == 1) { minute = '0'+minute;}\nif(second.toString().length == 1) { second = '0'+second;}\n\n\nvar dateString = \"C:/Data/G1Power_\"+year;\nmsg.filename = dateString+\".csv\";\n\nmsg.payload = {\n    \"TS\": ts,\n    \"P_AC\": msg.payload.Power.I.AC,\n    \"P_PV\": msg.payload.Power.I.PV,\n};\nmsg.columns = \"TS,P_AC,P_PV\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":1880,"wires":[["37547aff.55d4a6"]]},{"id":"37547aff.55d4a6","type":"csv","z":"3dddaeea.f4e652","name":"","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\r\\n","temp":"","skip":"0","strings":true,"include_empty_strings":true,"include_null_values":"","x":490,"y":1880,"wires":[["3c555a93.da3976"]]},{"id":"3c555a93.da3976","type":"file","z":"3dddaeea.f4e652","name":"","filename":"","appendNewline":false,"createDir":true,"overwriteFile":"false","encoding":"none","x":630,"y":1880,"wires":[["5ca84300.5916ec"]]},{"id":"edcc65cd.acb3e8","type":"comment","z":"3dddaeea.f4e652","name":"Get Last kW values","info":"","x":130,"y":2120,"wires":[]},{"id":"d3263605.ab9d18","type":"link in","z":"3dddaeea.f4e652","name":"Update File","links":["ea87a6d4.893d28","3ce40ab3.4ceeb6"],"x":215,"y":1720,"wires":[["f74f994d.ca7fa8"]]},{"id":"fd404e57.40b0b","type":"function","z":"90588a53.b682a8","name":"set Timer1","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/1/Time/1\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":60,"wires":[["8fbc00d6.eaa39"]]},{"id":"f3b8dcbb.66503","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nif(msg.topic == \"Enable\")\n{\n    payload.Timer1.C = msg.payload;\n}\nif(msg.topic == \"Monday\")\n{\n    payload.Timer1.W.Mo = msg.payload;\n}\nif(msg.topic == \"Tuesday\")\n{\n    payload.Timer1.W.Tu = msg.payload;\n}\nif(msg.topic == \"Wednesday\")\n{\n    payload.Timer1.W.We = msg.payload;\n}\nif(msg.topic == \"Thursday\")\n{\n    payload.Timer1.W.Th = msg.payload;\n}\nif(msg.topic == \"Friday\")\n{\n    payload.Timer1.W.Fr = msg.payload;\n}\nif(msg.topic == \"Saturday\")\n{\n    payload.Timer1.W.Sa = msg.payload;\n}\nif(msg.topic == \"Sunday\")\n{\n    payload.Timer1.W.Su = msg.payload;\n}\nif(msg.topic == \"OnTime\")\n{\n    var time = new Date(msg.payload);\n    var hour = time.getUTCHours();\n    var min = time.getMinutes();\n    \n    payload.Timer1.S.h = hour;\n    payload.Timer1.S.m = min;\n}\nif(msg.topic == \"OffTime\")\n{\n    var time2 = new Date(msg.payload);\n    var hour2 = time2.getUTCHours();\n    var min2 = time2.getMinutes();\n    \n    payload.Timer1.E.h = hour2;\n    payload.Timer1.E.m = min2;\n}\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":300,"wires":[[]]},{"id":"7fd2879f.b008b8","type":"json","z":"90588a53.b682a8","name":"","property":"payload","action":"","pretty":false,"x":430,"y":60,"wires":[["fd404e57.40b0b"]]},{"id":"108d7751.6c0529","type":"complete","z":"3dddaeea.f4e652","name":"Timers Complete","scope":["67681489.1825ac"],"uncaught":false,"x":160,"y":700,"wires":[["45d7a9d7.d20738"]]},{"id":"45d7a9d7.d20738","type":"link out","z":"3dddaeea.f4e652","name":"Timers1Complete","links":["df10ba8f.a36d38"],"x":295,"y":700,"wires":[]},{"id":"6b136e0b.67283","type":"ui_button","z":"90588a53.b682a8","name":"Refresh","group":"525bfa1b.1d4314","order":27,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":640,"wires":[["d52768e2.84ff78"]]},{"id":"5236470.6ef87b8","type":"comment","z":"90588a53.b682a8","name":"Timer 2","info":"","x":90,"y":600,"wires":[]},{"id":"37c1fcd7.998e44","type":"inject","z":"90588a53.b682a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":680,"wires":[["d52768e2.84ff78"]]},{"id":"ab850b29.9fbec8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Enable","tooltip":"","group":"525bfa1b.1d4314","order":16,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":760,"y":580,"wires":[["99b63404.fcb3e8"]]},{"id":"2c53c031.c96","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Mo","tooltip":"Monday","group":"525bfa1b.1d4314","order":20,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":600,"wires":[["91197818.ae22f8"]]},{"id":"c128f68e.3bd3e8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Tu","tooltip":"Tuesday","group":"525bfa1b.1d4314","order":21,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":620,"wires":[["de6d0962.ef8c98"]]},{"id":"4b17b54d.8ed33c","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"We","tooltip":"Wednesday","group":"525bfa1b.1d4314","order":22,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":640,"wires":[["3ef1e8e3.cc8a38"]]},{"id":"b0a4c875.86f8a8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Th","tooltip":"Thursday","group":"525bfa1b.1d4314","order":23,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":660,"wires":[["ebc5de16.c6d9c"]]},{"id":"7090d116.d712e","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Fr","tooltip":"Friday","group":"525bfa1b.1d4314","order":24,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":680,"wires":[["535f430d.82df6c"]]},{"id":"7f59257f.5b5f0c","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Sa","tooltip":"Saturday","group":"525bfa1b.1d4314","order":25,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":700,"wires":[["145c695a.78f3c7"]]},{"id":"7773e12.7623c2","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Su","tooltip":"Sunday","group":"525bfa1b.1d4314","order":26,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":720,"wires":[["a29b07cb.8d8128"]]},{"id":"c419cf78.abb63","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"On","tooltip":"On Time","group":"525bfa1b.1d4314","order":17,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":750,"y":740,"wires":[["16cb8541.0295ab"]]},{"id":"692b7755.22a3f8","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"Off","tooltip":"Off Time","group":"525bfa1b.1d4314","order":18,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":750,"y":760,"wires":[["2c633f31.3b6be"]]},{"id":"815477c2.b5c5c8","type":"ui_button","z":"90588a53.b682a8","name":"Save Data T2","group":"525bfa1b.1d4314","order":28,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":100,"wires":[["d3a004c0.389748"]]},{"id":"d3a004c0.389748","type":"function","z":"90588a53.b682a8","name":"","func":"var data = global.get(\"Geyser1Data\");\n\nmsg.payload = {\n    \"C\":data.Timer2.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer2.S.h),\n        \"m\": parseInt(data.Timer2.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer2.E.h),\n        \"m\": parseInt(data.Timer2.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer2.W.Mo,\n        \"Tu\": data.Timer2.W.Tu,\n        \"We\": data.Timer2.W.We,\n        \"Th\": data.Timer2.W.Th,\n        \"Fr\": data.Timer2.W.Fr,\n        \"Sa\": data.Timer2.W.Sa,\n        \"Su\": data.Timer2.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":100,"wires":[["63141297.c6abec"]]},{"id":"99b63404.fcb3e8","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.C = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":580,"wires":[[]]},{"id":"63141297.c6abec","type":"json","z":"90588a53.b682a8","name":"","property":"payload","action":"","pretty":false,"x":430,"y":100,"wires":[["336df394.c0050c"]]},{"id":"91197818.ae22f8","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.W.Mo = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":600,"wires":[[]]},{"id":"de6d0962.ef8c98","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.W.Tu = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":620,"wires":[[]]},{"id":"3ef1e8e3.cc8a38","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.W.We = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":640,"wires":[[]]},{"id":"ebc5de16.c6d9c","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.W.Th = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":660,"wires":[[]]},{"id":"535f430d.82df6c","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.W.Fr = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":680,"wires":[[]]},{"id":"145c695a.78f3c7","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.W.Sa = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":700,"wires":[[]]},{"id":"a29b07cb.8d8128","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer2.W.Su = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":720,"wires":[[]]},{"id":"16cb8541.0295ab","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer2.S.h = hour;\npayload.Timer2.S.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":740,"wires":[[]]},{"id":"2c633f31.3b6be","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer2.E.h = hour;\npayload.Timer2.E.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":760,"wires":[[]]},{"id":"e81e30e0.242bd","type":"ui_template","z":"90588a53.b682a8","group":"525bfa1b.1d4314","name":"Timer 1","order":1,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 1\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":520,"y":260,"wires":[[]]},{"id":"3d4b3d0a.4e5ce2","type":"ui_template","z":"90588a53.b682a8","group":"525bfa1b.1d4314","name":"Timer 2","order":15,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 2\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":540,"y":540,"wires":[[]]},{"id":"ac3f696.c6de898","type":"ui_button","z":"90588a53.b682a8","name":"Refresh","group":"525bfa1b.1d4314","order":41,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":920,"wires":[["480311dd.b7a44"]]},{"id":"1e3baf8e.dca7","type":"comment","z":"90588a53.b682a8","name":"Timer 3","info":"","x":90,"y":880,"wires":[]},{"id":"22811e6d.d018f2","type":"inject","z":"90588a53.b682a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":960,"wires":[["480311dd.b7a44"]]},{"id":"b6941d14.a6d12","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Enable","tooltip":"","group":"525bfa1b.1d4314","order":30,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":760,"y":860,"wires":[["fb39efdb.a41ef"]]},{"id":"c8a362b9.a3b46","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Mo","tooltip":"Monday","group":"525bfa1b.1d4314","order":34,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":880,"wires":[["9a9fbbd0.83b218"]]},{"id":"23f814bc.7ab05c","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Tu","tooltip":"Tuesday","group":"525bfa1b.1d4314","order":35,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":900,"wires":[["4f6a8224.85c07c"]]},{"id":"6e73d70a.e33578","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"We","tooltip":"Wednesday","group":"525bfa1b.1d4314","order":36,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":920,"wires":[["9b8c789d.56ca88"]]},{"id":"37abc4f5.08976c","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Th","tooltip":"Thursday","group":"525bfa1b.1d4314","order":37,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":940,"wires":[["79d29b5a.ee44c4"]]},{"id":"fee2354e.753268","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Fr","tooltip":"Friday","group":"525bfa1b.1d4314","order":38,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":960,"wires":[["c38f5c43.e00e"]]},{"id":"c0fc7013.aacdf","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Sa","tooltip":"Saturday","group":"525bfa1b.1d4314","order":39,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":980,"wires":[["34ef573.238fea8"]]},{"id":"fe4ee380.a324e","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Su","tooltip":"Sunday","group":"525bfa1b.1d4314","order":40,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1000,"wires":[["e993a252.bb426"]]},{"id":"b798f112.9d62d","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"On","tooltip":"On Time","group":"525bfa1b.1d4314","order":31,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":750,"y":1020,"wires":[["405d4f55.c07cf"]]},{"id":"f1177971.9186c8","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"Off","tooltip":"Off Time","group":"525bfa1b.1d4314","order":32,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":750,"y":1040,"wires":[["a82d6a04.1f7a78"]]},{"id":"9269f4b4.a11068","type":"ui_button","z":"90588a53.b682a8","name":"Save Data T3","group":"525bfa1b.1d4314","order":42,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":140,"wires":[["5f31f774.22e998"]]},{"id":"5f31f774.22e998","type":"function","z":"90588a53.b682a8","name":"","func":"var data = global.get(\"Geyser1Data\");\n\nmsg.payload = {\n    \"C\":data.Timer3.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer3.S.h),\n        \"m\": parseInt(data.Timer3.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer3.E.h),\n        \"m\": parseInt(data.Timer3.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer3.W.Mo,\n        \"Tu\": data.Timer3.W.Tu,\n        \"We\": data.Timer3.W.We,\n        \"Th\": data.Timer3.W.Th,\n        \"Fr\": data.Timer3.W.Fr,\n        \"Sa\": data.Timer3.W.Sa,\n        \"Su\": data.Timer3.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":140,"wires":[["b68f2950.5bdb98"]]},{"id":"fb39efdb.a41ef","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.C = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":860,"wires":[[]]},{"id":"b68f2950.5bdb98","type":"json","z":"90588a53.b682a8","name":"","property":"payload","action":"","pretty":false,"x":430,"y":140,"wires":[["f54ba2dd.00d2"]]},{"id":"9a9fbbd0.83b218","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.W.Mo = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":880,"wires":[[]]},{"id":"4f6a8224.85c07c","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.W.Tu = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":900,"wires":[[]]},{"id":"9b8c789d.56ca88","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.W.We = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":920,"wires":[[]]},{"id":"79d29b5a.ee44c4","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.W.Th = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":940,"wires":[[]]},{"id":"c38f5c43.e00e","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.W.Fr = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":960,"wires":[[]]},{"id":"34ef573.238fea8","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.W.Sa = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":980,"wires":[[]]},{"id":"e993a252.bb426","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer3.W.Su = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1000,"wires":[[]]},{"id":"405d4f55.c07cf","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer3.S.h = hour;\npayload.Timer3.S.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1020,"wires":[[]]},{"id":"a82d6a04.1f7a78","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer3.E.h = hour;\npayload.Timer3.E.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1040,"wires":[[]]},{"id":"1f8153f0.c283fc","type":"ui_template","z":"90588a53.b682a8","group":"525bfa1b.1d4314","name":"Timer 3","order":29,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 3\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":540,"y":820,"wires":[[]]},{"id":"1f6eb8e3.8e5007","type":"ui_button","z":"90588a53.b682a8","name":"Refresh","group":"525bfa1b.1d4314","order":55,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":1200,"wires":[["d1493c64.761d6"]]},{"id":"96915baf.8d1298","type":"comment","z":"90588a53.b682a8","name":"Timer 4","info":"","x":90,"y":1160,"wires":[]},{"id":"4a722787.d08df8","type":"inject","z":"90588a53.b682a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":1240,"wires":[["d1493c64.761d6"]]},{"id":"1279d59e.2315ca","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Enable","tooltip":"","group":"525bfa1b.1d4314","order":44,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":760,"y":1140,"wires":[["97b9301a.1bd06"]]},{"id":"84f4a5ba.7a0298","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Mo","tooltip":"Monday","group":"525bfa1b.1d4314","order":48,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1160,"wires":[["6fbb2f0a.9c18b"]]},{"id":"3b85c35a.d66a6c","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Tu","tooltip":"Tuesday","group":"525bfa1b.1d4314","order":49,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1180,"wires":[["5dbb3903.bf4588"]]},{"id":"4faf57e2.6d2e08","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"We","tooltip":"Wednesday","group":"525bfa1b.1d4314","order":50,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1200,"wires":[["282bc635.2f668a"]]},{"id":"a0277da8.7b7ea","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Th","tooltip":"Thursday","group":"525bfa1b.1d4314","order":51,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1220,"wires":[["ed360931.606378"]]},{"id":"875526d2.33a1b8","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Fr","tooltip":"Friday","group":"525bfa1b.1d4314","order":52,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1240,"wires":[["69404559.52918c"]]},{"id":"2054bc0f.2d9514","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Sa","tooltip":"Saturday","group":"525bfa1b.1d4314","order":53,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1260,"wires":[["f7a870e7.c554e"]]},{"id":"e126848c.6d7528","type":"ui_switch","z":"90588a53.b682a8","name":"","label":"Su","tooltip":"Sunday","group":"525bfa1b.1d4314","order":54,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":750,"y":1280,"wires":[["12615f19.ffea71"]]},{"id":"7ef5717f.8f5d8","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"On","tooltip":"On Time","group":"525bfa1b.1d4314","order":45,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":750,"y":1300,"wires":[["e8766a1b.95f798"]]},{"id":"7d31b1c6.46e5d","type":"ui_text_input","z":"90588a53.b682a8","name":"","label":"Off","tooltip":"Off Time","group":"525bfa1b.1d4314","order":46,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":750,"y":1320,"wires":[["4dec9b70.a9ba14"]]},{"id":"493f412b.1e3a7","type":"ui_button","z":"90588a53.b682a8","name":"Save Data T4","group":"525bfa1b.1d4314","order":56,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":180,"wires":[["af4cf513.bc5c58"]]},{"id":"af4cf513.bc5c58","type":"function","z":"90588a53.b682a8","name":"","func":"var data = global.get(\"Geyser1Data\");\n\nmsg.payload = {\n    \"C\":data.Timer4.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer4.S.h),\n        \"m\": parseInt(data.Timer4.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer4.E.h),\n        \"m\": parseInt(data.Timer4.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer4.W.Mo,\n        \"Tu\": data.Timer4.W.Tu,\n        \"We\": data.Timer4.W.We,\n        \"Th\": data.Timer4.W.Th,\n        \"Fr\": data.Timer4.W.Fr,\n        \"Sa\": data.Timer4.W.Sa,\n        \"Su\": data.Timer4.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":180,"wires":[["369c968a.9b1f2a"]]},{"id":"97b9301a.1bd06","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.C = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1140,"wires":[[]]},{"id":"369c968a.9b1f2a","type":"json","z":"90588a53.b682a8","name":"","property":"payload","action":"","pretty":false,"x":430,"y":180,"wires":[["5ab12939.d38588"]]},{"id":"6fbb2f0a.9c18b","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.W.Mo = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1160,"wires":[[]]},{"id":"5dbb3903.bf4588","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.W.Tu = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1180,"wires":[[]]},{"id":"282bc635.2f668a","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.W.We = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1200,"wires":[[]]},{"id":"ed360931.606378","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.W.Th = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1220,"wires":[[]]},{"id":"69404559.52918c","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.W.Fr = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1240,"wires":[[]]},{"id":"f7a870e7.c554e","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.W.Sa = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1260,"wires":[[]]},{"id":"12615f19.ffea71","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\npayload.Timer4.W.Su = msg.payload;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1280,"wires":[[]]},{"id":"e8766a1b.95f798","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer4.S.h = hour;\npayload.Timer4.S.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1300,"wires":[[]]},{"id":"4dec9b70.a9ba14","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer4.E.h = hour;\npayload.Timer4.E.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":1320,"wires":[[]]},{"id":"beb13e36.9889f","type":"ui_template","z":"90588a53.b682a8","group":"525bfa1b.1d4314","name":"Timer 4","order":43,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 4\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":540,"y":1100,"wires":[[]]},{"id":"34b0dd74.25df92","type":"ui_text_input","z":"5395d339.48846c","name":"","label":"System Time","tooltip":"System Time","group":"efe91aea.44c2b8","order":2,"width":0,"height":0,"passthru":true,"mode":"time","delay":"0","topic":"topic","topicType":"msg","x":450,"y":500,"wires":[[]]},{"id":"a5a51498.5b8308","type":"ui_text_input","z":"5395d339.48846c","name":"","label":"GeyserWorx Time","tooltip":"GeyserWorx Time","group":"efe91aea.44c2b8","order":3,"width":0,"height":0,"passthru":false,"mode":"time","delay":"0","topic":"topic","topicType":"msg","x":470,"y":540,"wires":[[]]},{"id":"528d2590.1aa97c","type":"ui_button","z":"5395d339.48846c","name":"Refresh Time","group":"efe91aea.44c2b8","order":4,"width":"3","height":"1","passthru":false,"label":"","tooltip":"Update Time","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":110,"y":500,"wires":[["97886d44.7b41c","2fa40384.478d7c"]]},{"id":"db877f59.df9e5","type":"ui_button","z":"5395d339.48846c","name":"Set Time","group":"efe91aea.44c2b8","order":5,"width":"3","height":"1","passthru":false,"label":"","tooltip":"Set time on GeyserWorx","color":"","bgcolor":"","icon":"fa-download fa-2x","payload":"Set","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":580,"wires":[["eca8063a.446df8"]]},{"id":"97886d44.7b41c","type":"function","z":"5395d339.48846c","name":"","func":"var time = new Date();\n\nmsg.payload = time.getTime();\nflow.set(\"Year\", time.getFullYear());\nflow.set(\"Month\", time.getMonth()+1);\nflow.set(\"Day\", time.getDate());\nflow.set(\"Hour\", time.getHours())+2;\nflow.set(\"Minute\", time.getMinutes());\n\nvar time2 = new Date(time.getFullYear(),time.getMonth()+1,time.getDate(),time.getHours()+2,time.getMinutes(),0,0);\nmsg.payload = time2.getTime();\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":500,"wires":[["34b0dd74.25df92"]]},{"id":"3a7bc44e.28440c","type":"link in","z":"3dddaeea.f4e652","name":"Time Data","links":["2fa40384.478d7c"],"x":175,"y":260,"wires":[["c8c97430.ce8cb8"]]},{"id":"2fa40384.478d7c","type":"link out","z":"5395d339.48846c","name":"","links":["3a7bc44e.28440c","4b0de0ea.00fd2"],"x":235,"y":480,"wires":[]},{"id":"2c01e81c.3524c8","type":"function","z":"5395d339.48846c","name":"","func":"var data = global.get(\"Geyser1Data\");\nvar year = data.Time.Y;\nvar month = data.Time.M;\nvar day = data.Time.D;\nvar hour = data.Time.h;\nvar min = data.Time.m;\n\nvar time = new Date(year,month,day,hour+2,min,0,0);\n\nmsg.payload = time.getTime();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":540,"wires":[["a5a51498.5b8308","fc9c74bd.1af2c8"]]},{"id":"3b11cbd4.9df1e4","type":"link out","z":"3dddaeea.f4e652","name":"TimeCheck","links":["ce588467.20d678"],"x":855,"y":40,"wires":[]},{"id":"ce588467.20d678","type":"link in","z":"5395d339.48846c","name":"TimeCheckCompl","links":["3b11cbd4.9df1e4"],"x":175,"y":540,"wires":[["2c01e81c.3524c8"]]},{"id":"eca8063a.446df8","type":"function","z":"5395d339.48846c","name":"","func":"var Y = flow.get(\"Year\");\nvar M = flow.get(\"Month\");\nvar D = flow.get(\"Day\");\nvar h = flow.get(\"Hour\");\nvar m = flow.get(\"Minute\");\nvar unit = global.get(\"unit\");\nmsg.payload = {\n    // {\"Y\":1990,\"M\":12,\"D\":31,\"h\":12,\"m\":30}\n    \"Y\":Y,\n    \"M\":M,\n    \"D\":D,\n    \"h\":h,\n    \"m\":m\n};\nmsg.topic = \"GWR/\"+unit+\"/S/Time/G\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":240,"y":580,"wires":[["fcd48b5.d468d78","49095220.6179bc"]]},{"id":"7b15fd27.2486b4","type":"ui_template","z":"5395d339.48846c","group":"efe91aea.44c2b8","name":"Group Title","order":1,"width":"0","height":"0","format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        >GeyserWorx Time Set\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":330,"y":440,"wires":[[]]},{"id":"17af73a5.d597ec","type":"comment","z":"5395d339.48846c","name":"GeyserWorx Time Setting","info":"","x":130,"y":440,"wires":[]},{"id":"54242126.5e2c","type":"comment","z":"5395d339.48846c","name":"GeyserWorx Configuration","info":"","x":130,"y":40,"wires":[]},{"id":"a590206b.cf31e","type":"ui_button","z":"5395d339.48846c","name":"Refresh Data","group":"9a9a4f5d.b30e5","order":4,"width":"0","height":"0","passthru":false,"label":"","tooltip":"Refresh System Configuration","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":110,"y":120,"wires":[["328ace3e.a7a0a2"]]},{"id":"8a353bb0.1b6a98","type":"comment","z":"94e0adf3.31d6b","name":"Enable Timers","info":"","x":110,"y":660,"wires":[]},{"id":"200e6e03.a08f02","type":"function","z":"94e0adf3.31d6b","name":"","func":"var data = global.get(\"Geyser1Data\");\n\nmsg.payload = data.Timers.C;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":700,"wires":[["a0e02216.15653"]]},{"id":"a0e02216.15653","type":"ui_switch","z":"94e0adf3.31d6b","name":"","label":"Timers Enabled","tooltip":"","group":"b0690eac.2cf5f","order":23,"width":"0","height":"0","passthru":true,"decouple":"false","topic":"topic","topicType":"msg","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-window-close","offcolor":"grey","animate":true,"x":460,"y":700,"wires":[["86dab60c.e299c8"]]},{"id":"86dab60c.e299c8","type":"function","z":"94e0adf3.31d6b","name":"Set value","func":"var payload = msg.payload;\n\nmsg.payload = {\"C\":payload};\nmsg.topic = \"GWR/\"+flow.get(\"unit\")+\"/1/Time\";\nnode.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":640,"y":700,"wires":[["dca728c5.82e408"]]},{"id":"df10ba8f.a36d38","type":"link in","z":"94e0adf3.31d6b","name":"","links":["45d7a9d7.d20738","aae1729f.c5a51"],"x":175,"y":700,"wires":[["200e6e03.a08f02"]]},{"id":"fcd48b5.d468d78","type":"debug","z":"5395d339.48846c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":390,"y":600,"wires":[]},{"id":"dd4f223c.32f4f","type":"inject","z":"3dddaeea.f4e652","name":"Update","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":500,"wires":[["9277515.474c9b"]]},{"id":"454f1f89.e341b","type":"debug","z":"5395d339.48846c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":640,"y":140,"wires":[]},{"id":"a3259a19.3dda48","type":"ui_ui_control","z":"5395d339.48846c","name":"","events":"all","x":620,"y":340,"wires":[[]]},{"id":"3445160c.2478da","type":"inject","z":"5395d339.48846c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":340,"wires":[["40be8d48.ffb9f4"]]},{"id":"40be8d48.ffb9f4","type":"function","z":"5395d339.48846c","name":"Dual system check","func":"var G2Enable = global.get(\"Dual\");\nif(G2Enable)\n{\n    msg.payload = {\"tabs\":{\"show\":\"Geyser 2\"}};\n}\nelse\n{\n    msg.payload = {\"tabs\":{\"hide\":\"Geyser 2\"}};\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":310,"y":340,"wires":[["a3259a19.3dda48"]]},{"id":"d69e037.8af88","type":"link out","z":"5395d339.48846c","name":"","links":["556cd732.886048"],"x":755,"y":80,"wires":[]},{"id":"556cd732.886048","type":"link in","z":"5395d339.48846c","name":"DualUpdate","links":["d69e037.8af88"],"x":75,"y":300,"wires":[["40be8d48.ffb9f4"]]},{"id":"533de581.63092c","type":"comment","z":"3dddaeea.f4e652","name":"Geyser 1 Data Sampling","info":"","x":170,"y":220,"wires":[]},{"id":"64ee53dd.bd4cdc","type":"link out","z":"3dddaeea.f4e652","name":"HTTP Req Complete 2","links":["c7061bd4.2ae5d8"],"x":295,"y":1320,"wires":[]},{"id":"aeeb33db.3118b","type":"comment","z":"3dddaeea.f4e652","name":"Geyser 2 Data Sampling","info":"","x":150,"y":820,"wires":[]},{"id":"463a2519.b7fb4c","type":"function","z":"3dddaeea.f4e652","name":"Timer Status","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.url = \"http://\"+addr+\"/gwa?topic=GWA/\"+unit+\"/2/Time/C\";\nmsg.topic = \"Timers\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":1760,"wires":[[]]},{"id":"8a0739ce.533a78","type":"link in","z":"3dddaeea.f4e652","name":"Timers 2 Data","links":["ae61b7ba.da87d8"],"x":255,"y":1760,"wires":[["b8df7311.8848f"]]},{"id":"7815a989.c25958","type":"inject","z":"3dddaeea.f4e652","name":"Update","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":140,"y":1760,"wires":[["b8df7311.8848f"]]},{"id":"b8df7311.8848f","type":"switch","z":"3dddaeea.f4e652","name":"","property":"Dual","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":350,"y":1760,"wires":[["463a2519.b7fb4c"]]},{"id":"a6560756.14e028","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"Dial","order":12,"width":4,"height":4,"format":"<div id=\"thermostat\"></div>\n\n<style>\n@import url(http://fonts.googleapis.com/css?family=Open+Sans:300);\n#thermostat {\n  margin: 0 auto;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n.dial {\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.dial.away .dial__ico__leaf {\n  visibility: hidden;\n}\n.dial.away .dial__lbl--target {\n  visibility: hidden;\n}\n.dial.away .dial__lbl--target--half {\n  visibility: hidden;\n}\n.dial.away .dial__lbl--away {\n  opacity: 1;\n}\n.dial .dial__shape {\n  -webkit-transition: fill 0.5s;\n  transition: fill 0.5s;\n}\n.dial__ico__leaf {\n  fill: #13EB13;\n  opacity: 0;\n  -webkit-transition: opacity 0.5s;\n  transition: opacity 0.5s;\n  pointer-events: none;\n}\n.dial.has-leaf .dial__ico__leaf {\n  display: block;\n  opacity: 1;\n  pointer-events: initial;\n}\n.dial__editableIndicator {\n  fill: white;\n  fill-rule: evenodd;\n  opacity: 0;\n  -webkit-transition: opacity 0.5s;\n  transition: opacity 0.5s;\n}\n.dial--edit .dial__editableIndicator {\n  opacity: 1;\n}\n.dial--state--off .dial__shape {\n  fill: #3d3c3c;\n}\n.dial--state--heating .dial__shape {\n  fill: #E36304;\n}\n.dial--state--cooling .dial__shape {\n  fill: #3c9517;\n}\n.dial__ticks path {\n  fill: rgba(255, 255, 255, 0.3);\n}\n.dial__ticks path.active {\n  fill: rgba(255, 255, 255, 0.8);\n}\n.dial text {\n  fill: white;\n  text-anchor: middle;\n  font-family: Helvetica, sans-serif;\n  alignment-baseline: central;\n}\n.dial__lbl--target {\n  font-size: 120px;\n  font-weight: bold;\n}\n.dial__lbl--target--half {\n  font-size: 40px;\n  font-weight: bold;\n  opacity: 0;\n  -webkit-transition: opacity 0.1s;\n  transition: opacity 0.1s;\n}\n.dial__lbl--target--half.shown {\n  opacity: 1;\n  -webkit-transition: opacity 0s;\n  transition: opacity 0s;\n}\n.dial__lbl--ambient {\n  font-size: 22px;\n  font-weight: bold;\n}\n.dial__lbl--away {\n  font-size: 72px;\n  font-weight: bold;\n  opacity: 0;\n  pointer-events: none;\n}\n#controls {\n  font-family: Open Sans;\n  background-color: rgba(255, 255, 255, 0.25);\n  padding: 20px;\n  border-radius: 5px;\n  position: absolute;\n  left: 50%;\n  -webkit-transform: translatex(-50%);\n          transform: translatex(-50%);\n  margin-top: 20px;\n}\n#controls label {\n  text-align: left;\n  display: block;\n}\n#controls label span {\n  display: inline-block;\n  width: 200px;\n  text-align: right;\n  font-size: 0.8em;\n  text-transform: uppercase;\n}\n#controls p {\n  margin: 0;\n  margin-bottom: 1em;\n  padding-bottom: 1em;\n  border-bottom: 2px solid #ccc;\n}\n</style>\n<script>\n    var thermostatDial = (function() {\n\t\n\t/*\n\t * Utility functions\n\t */\n\t\n\t// Create an element with proper SVG namespace, optionally setting its attributes and appending it to another element\n\tfunction createSVGElement(tag,attributes,appendTo) {\n\t\tvar element = document.createElementNS('http://www.w3.org/2000/svg',tag);\n\t\tattr(element,attributes);\n\t\tif (appendTo) {\n\t\t\tappendTo.appendChild(element);\n\t\t}\n\t\treturn element;\n\t}\n\t\n\t// Set attributes for an element\n\tfunction attr(element,attrs) {\n\t\tfor (var i in attrs) {\n\t\t\telement.setAttribute(i,attrs[i]);\n\t\t}\n\t}\n\t\n\t// Rotate a cartesian point about given origin by X degrees\n\tfunction rotatePoint(point, angle, origin) {\n\t\tvar radians = angle * Math.PI/180;\n\t\tvar x = point[0]-origin[0];\n\t\tvar y = point[1]-origin[1];\n\t\tvar x1 = x*Math.cos(radians) - y*Math.sin(radians) + origin[0];\n\t\tvar y1 = x*Math.sin(radians) + y*Math.cos(radians) + origin[1];\n\t\treturn [x1,y1];\n\t}\n\t\n\t// Rotate an array of cartesian points about a given origin by X degrees\n\tfunction rotatePoints(points, angle, origin) {\n\t\treturn points.map(function(point) {\n\t\t\treturn rotatePoint(point, angle, origin);\n\t\t});\n\t}\n\t\n\t// Given an array of points, return an SVG path string representing the shape they define\n\tfunction pointsToPath(points) {\n\t\treturn points.map(function(point, iPoint) {\n\t\t\treturn (iPoint>0?'L':'M') + point[0] + ' ' + point[1];\n\t\t}).join(' ')+'Z';\n\t}\n\t\n\tfunction circleToPath(cx, cy, r) {\n\t\treturn [\n\t\t\t\"M\",cx,\",\",cy,\n\t\t\t\"m\",0-r,\",\",0,\n\t\t\t\"a\",r,\",\",r,0,1,\",\",0,r*2,\",\",0,\n\t\t\t\"a\",r,\",\",r,0,1,\",\",0,0-r*2,\",\",0,\n\t\t\t\"z\"\n\t\t].join(' ').replace(/\\s,\\s/g,\",\");\n\t}\n\t\n\tfunction donutPath(cx,cy,rOuter,rInner) {\n\t\treturn circleToPath(cx,cy,rOuter) + \" \" + circleToPath(cx,cy,rInner);\n\t}\n\t\n\t// Restrict a number to a min + max range\n\tfunction restrictToRange(val,min,max) {\n\t\tif (val < min) return min;\n\t\tif (val > max) return max;\n\t\treturn val;\n\t}\n\t\n\t// Round a number to the nearest 0.5\n\tfunction roundHalf(num) {\n\t\treturn Math.round(num*2)/2;\n\t}\n\t\n\tfunction setClass(el, className, state) {\n\t\tel.classList[state ? 'add' : 'remove'](className);\n\t}\n\t\n\t/*\n\t * The \"MEAT\"\n\t */\n\n\treturn function(targetElement, options) {\n\t\tvar self = this;\n\t\t\n\t\t/*\n\t\t * Options\n\t\t */\n\t\toptions = options || {};\n\t\toptions = {\n\t\t\tdiameter: options.diameter || 400,\n\t\t\tminValue: options.minValue || 00, // Minimum value for target temperature\n\t\t\tmaxValue: options.maxValue || 85, // Maximum value for target temperature\n\t\t\tnumTicks: options.numTicks || 200, // Number of tick lines to display around the dial\n\t\t\tonSetTargetTemperature: options.onSetTargetTemperature || function() {}, // Function called when new target temperature set by the dial\n\t\t};\n\t\t\n\t\t/*\n\t\t * Properties - calculated from options in many cases\n\t\t */\n\t\tvar properties = {\n\t\t\ttickDegrees: 300, //  Degrees of the dial that should be covered in tick lines\n\t\t\trangeValue: options.maxValue - options.minValue,\n\t\t\tradius: options.diameter/2,\n\t\t\tticksOuterRadius: options.diameter / 30,\n\t\t\tticksInnerRadius: options.diameter / 8,\n\t\t\thvac_states: ['off', 'heating', 'cooling'],\n\t\t\tdragLockAxisDistance: 15,\n\t\t}\n\t\tproperties.lblAmbientPosition = [properties.radius, properties.ticksOuterRadius-(properties.ticksOuterRadius-properties.ticksInnerRadius)/2]\n\t\tproperties.offsetDegrees = 180-(360-properties.tickDegrees)/2;\n\t\t\n\t\t/*\n\t\t * Object state\n\t\t */\n\t\tvar state = {\n\t\t\ttarget_temperature: options.minValue,\n\t\t\tambient_temperature: options.minValue,\n\t\t\thvac_state: properties.hvac_states[0],\n\t\t\thas_leaf: false,\n\t\t\taway: false\n\t\t};\n\t\t\n\t\t/*\n\t\t * Property getter / setters\n\t\t */\n\t\tObject.defineProperty(this,'target_temperature',{\n\t\t\tget: function() {\n\t\t\t\treturn state.target_temperature;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.target_temperature = restrictTargetTemperature(+val);\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'ambient_temperature',{\n\t\t\tget: function() {\n\t\t\t\treturn state.ambient_temperature;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.ambient_temperature = roundHalf(+val);\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'hvac_state',{\n\t\t\tget: function() {\n\t\t\t\treturn state.hvac_state;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tif (properties.hvac_states.indexOf(val)>=0) {\n\t\t\t\t\tstate.hvac_state = val;\n\t\t\t\t\trender();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'has_leaf',{\n\t\t\tget: function() {\n\t\t\t\treturn state.has_leaf;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.has_leaf = !!val;\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(this,'away',{\n\t\t\tget: function() {\n\t\t\t\treturn state.away;\n\t\t\t},\n\t\t\tset: function(val) {\n\t\t\t\tstate.away = !!val;\n\t\t\t\trender();\n\t\t\t}\n\t\t});\n\t\t\n\t\t/*\n\t\t * SVG\n\t\t */\n\t\tvar svg = createSVGElement('svg',{\n\t\t\twidth: '100%', //options.diameter+'px',\n\t\t\theight: '100%', //options.diameter+'px',\n\t\t\tviewBox: '0 0 '+options.diameter+' '+options.diameter,\n\t\t\tclass: 'dial'\n\t\t},targetElement);\n\t\t// CIRCULAR DIAL\n\t\tvar circle = createSVGElement('circle',{\n\t\t\tcx: properties.radius,\n\t\t\tcy: properties.radius,\n\t\t\tr: properties.radius,\n\t\t\tclass: 'dial__shape'\n\t\t},svg);\n\t\t// EDITABLE INDICATOR\n\t\tvar editCircle = createSVGElement('path',{\n\t\t\td: donutPath(properties.radius,properties.radius,properties.radius-4,properties.radius-8),\n\t\t\tclass: 'dial__editableIndicator',\n\t\t},svg);\n\t\t\n\t\t/*\n\t\t * Ticks\n\t\t */\n\t\tvar ticks = createSVGElement('g',{\n\t\t\tclass: 'dial__ticks'\t\n\t\t},svg);\n\t\tvar tickPoints = [\n\t\t\t[properties.radius-1, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1, properties.ticksInnerRadius],\n\t\t\t[properties.radius-1, properties.ticksInnerRadius]\n\t\t];\n\t\tvar tickPointsLarge = [\n\t\t\t[properties.radius-1.5, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1.5, properties.ticksOuterRadius],\n\t\t\t[properties.radius+1.5, properties.ticksInnerRadius+20],\n\t\t\t[properties.radius-1.5, properties.ticksInnerRadius+20]\n\t\t];\n\t\tvar theta = properties.tickDegrees/options.numTicks;\n\t\tvar tickArray = [];\n\t\tfor (var iTick=0; iTick<options.numTicks; iTick++) {\n\t\t\ttickArray.push(createSVGElement('path',{d:pointsToPath(tickPoints)},ticks));\n\t\t};\n\t\t\n\t\t/*\n\t\t * Labels\n\t\t */\n\t\tvar lblTarget = createSVGElement('text',{\n\t\t\tx: properties.radius,\n\t\t\ty: properties.radius,\n\t\t\tclass: 'dial__lbl dial__lbl--target'\n\t\t},svg);\n\t\tvar lblTarget_text = document.createTextNode('');\n\t\tlblTarget.appendChild(lblTarget_text);\n\t\t//\n\t\tvar lblTargetHalf = createSVGElement('text',{\n\t\t\tx: properties.radius + properties.radius/2.5,\n\t\t\ty: properties.radius - properties.radius/8,\n\t\t\tclass: 'dial__lbl dial__lbl--target--half'\n\t\t},svg);\n\t\tvar lblTargetHalf_text = document.createTextNode('5');\n\t\tlblTargetHalf.appendChild(lblTargetHalf_text);\n\t\t//\n\t\tvar lblAmbient = createSVGElement('text',{\n\t\t\tclass: 'dial__lbl dial__lbl--ambient'\n\t\t},svg);\n\t\tvar lblAmbient_text = document.createTextNode('');\n\t\tlblAmbient.appendChild(lblAmbient_text);\n\t\t//\n\t\tvar lblAway = createSVGElement('text',{\n\t\t\tx: properties.radius,\n\t\t\ty: properties.radius,\n\t\t\tclass: 'dial__lbl dial__lbl--away'\n\t\t},svg);\n\t\tvar lblAway_text = document.createTextNode('AWAY');\n\t\tlblAway.appendChild(lblAway_text);\n\t\t//\n\t\tvar icoLeaf = createSVGElement('path',{\n\t\t\tclass: 'dial__ico__leaf'\n\t\t},svg);\n\t\t\n\t\t/*\n\t\t * LEAF\n\t\t */\n\t\tvar leafScale = properties.radius/5/100;\n\t\tvar leafDef = [\"M\", 3, 84, \"c\", 24, 17, 51, 18, 73, -6, \"C\", 100, 52, 100, 22, 100, 4, \"c\", -13, 15, -37, 9, -70, 19, \"C\", 4, 32, 0, 63, 0, 76, \"c\", 6, -7, 18, -17, 33, -23, 24, -9, 34, -9, 48, -20, -9, 10, -20, 16, -43, 24, \"C\", 22, 63, 8, 78, 3, 84, \"z\"].map(function(x) {\n\t\t\treturn isNaN(x) ? x : x*leafScale;\n\t\t}).join(' ');\n\t\tvar translate = [properties.radius-(leafScale*100*0.5),properties.radius*1.5]\n\t\tvar icoLeaf = createSVGElement('path',{\n\t\t\tclass: 'dial__ico__leaf',\n\t\t\td: leafDef,\n\t\t\ttransform: 'translate('+translate[0]+','+translate[1]+')'\n\t\t},svg);\n\t\t\t\n\t\t/*\n\t\t * RENDER\n\t\t */\n\t\tfunction render() {\n\t\t\trenderAway();\n\t\t\trenderHvacState();\n\t\t\trenderTicks();\n\t\t\trenderTargetTemperature();\n\t\t\trenderAmbientTemperature();\n\t\t\trenderLeaf();\n\t\t}\n\t\trender();\n\n\t\t/*\n\t\t * RENDER - ticks\n\t\t */\n\t\tfunction renderTicks() {\n\t\t\tvar vMin, vMax;\n\t\t\tif (self.away) {\n\t\t\t\tvMin = self.ambient_temperature;\n\t\t\t\tvMax = vMin;\n\t\t\t} else {\n\t\t\t\tvMin = Math.min(self.ambient_temperature, self.target_temperature);\n\t\t\t\tvMax = Math.max(self.ambient_temperature, self.target_temperature);\n\t\t\t}\n\t\t\tvar min = restrictToRange(Math.round((vMin-options.minValue)/properties.rangeValue * options.numTicks),0,options.numTicks-1);\n\t\t\tvar max = restrictToRange(Math.round((vMax-options.minValue)/properties.rangeValue * options.numTicks),0,options.numTicks-1);\n\t\t\t//\n\t\t\ttickArray.forEach(function(tick,iTick) {\n\t\t\t\tvar isLarge = iTick==min || iTick==max;\n\t\t\t\tvar isActive = iTick >= min && iTick <= max;\n\t\t\t\tattr(tick,{\n\t\t\t\t\td: pointsToPath(rotatePoints(isLarge ? tickPointsLarge: tickPoints,iTick*theta-properties.offsetDegrees,[properties.radius, properties.radius])),\n\t\t\t\t\tclass: isActive ? 'active' : ''\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\n\t\t/*\n\t\t * RENDER - ambient temperature\n\t\t */\n\t\tfunction renderAmbientTemperature() {\n\t\t\tlblAmbient_text.nodeValue = Math.floor(self.ambient_temperature);\n\t\t\tif (self.ambient_temperature%1!=0) {\n\t\t\t\tlblAmbient_text.nodeValue += 'âµ';\n\t\t\t}\n\t\t\tvar peggedValue = restrictToRange(self.ambient_temperature, options.minValue, options.maxValue);\n\t\t\tdegs = properties.tickDegrees * (peggedValue-options.minValue)/properties.rangeValue - properties.offsetDegrees;\n\t\t\tif (peggedValue > self.target_temperature) {\n\t\t\t\tdegs += 8;\n\t\t\t} else {\n\t\t\t\tdegs -= 8;\n\t\t\t}\n\t\t\tvar pos = rotatePoint(properties.lblAmbientPosition,degs,[properties.radius, properties.radius]);\n\t\t\tattr(lblAmbient,{\n\t\t\t\tx: pos[0],\n\t\t\t\ty: pos[1]\n\t\t\t});\n\t\t}\n\n\t\t/*\n\t\t * RENDER - target temperature\n\t\t */\n\t\tfunction renderTargetTemperature() {\n\t\t\tlblTarget_text.nodeValue = Math.floor(self.target_temperature);\n\t\t\tsetClass(lblTargetHalf,'shown',self.target_temperature%1!=0);\n\t\t}\n\t\t\n\t\t/*\n\t\t * RENDER - leaf\n\t\t */\n\t\tfunction renderLeaf() {\n\t\t\tsetClass(svg,'has-leaf',self.has_leaf);\n\t\t}\n\t\t\n\t\t/*\n\t\t * RENDER - HVAC state\n\t\t */\n\t\tfunction renderHvacState() {\n\t\t\tArray.prototype.slice.call(svg.classList).forEach(function(c) {\n\t\t\t\tif (c.match(/^dial--state--/)) {\n\t\t\t\t\tsvg.classList.remove(c);\n\t\t\t\t};\n\t\t\t});\n\t\t\tsvg.classList.add('dial--state--'+self.hvac_state);\n\t\t}\n\t\t\n\t\t/*\n\t\t * RENDER - away\n\t\t */\n\t\tfunction renderAway() {\n\t\t\tsvg.classList[self.away ? 'add' : 'remove']('away');\n\t\t}\n\t\t\n\t\t/*\n\t\t * Drag to control\n\t\t */\n\t\tvar _drag = {\n\t\t\tinProgress: false,\n\t\t\tstartPoint: null,\n\t\t\tstartTemperature: 0,\n\t\t\tlockAxis: undefined\n\t\t};\n\t\t\n\t\tfunction eventPosition(ev) {\n\t\t\tif (ev.targetTouches && ev.targetTouches.length) {\n\t\t\t\treturn  [ev.targetTouches[0].clientX, ev.targetTouches[0].clientY];\n\t\t\t} else {\n\t\t\t\treturn [ev.x, ev.y];\n\t\t\t};\n\t\t}\n\t\t\n\t\tvar startDelay;\n\t\tfunction dragStart(ev) {\n\t\t\tstartDelay = setTimeout(function() {\n\t\t\t\tsetClass(svg, 'dial--edit', true);\n\t\t\t\t_drag.inProgress = true;\n\t\t\t\t_drag.startPoint = eventPosition(ev);\n\t\t\t\t_drag.startTemperature = self.ambient_temperature || options.minValue;\n\t\t\t\t_drag.lockAxis = undefined;\n\t\t\t},1000);\n\t\t};\n\t\t\n\t\tfunction dragEnd (ev) {\n\t\t\tclearTimeout(startDelay);\n\t\t\tsetClass(svg, 'dial--edit', false);\n\t\t\tif (!_drag.inProgress) return;\n\t\t\t_drag.inProgress = false;\n\t\t\tif (self.ambient_temperature != _drag.startTemperature) {\n\t\t\t\tif (typeof options.onSetTargetTemperature == 'function') {\n\t\t\t\t\toptions.onSetTargetTemperature(self.ambient_temperature);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\tfunction dragMove(ev) {\n\t\t\tev.preventDefault();\n\t\t\tif (!_drag.inProgress) return;\n\t\t\tvar evPos =  eventPosition(ev);\n\t\t\tvar dy = _drag.startPoint[1]-evPos[1];\n\t\t\tvar dx = evPos[0] - _drag.startPoint[0];\n\t\t\tvar dxy;\n\t\t\tif (_drag.lockAxis == 'x') {\n\t\t\t\tdxy  = dx;\n\t\t\t} else if (_drag.lockAxis == 'y') {\n\t\t\t\tdxy = dy;\n\t\t\t} else if (Math.abs(dy) > properties.dragLockAxisDistance) {\n\t\t\t\t_drag.lockAxis = 'y';\n\t\t\t\tdxy = dy;\n\t\t\t} else if (Math.abs(dx) > properties.dragLockAxisDistance) {\n\t\t\t\t_drag.lockAxis = 'x';\n\t\t\t\tdxy = dx;\n\t\t\t} else {\n\t\t\t\tdxy = (Math.abs(dy) > Math.abs(dx)) ? dy : dx;\n\t\t\t};\n\t\t\tvar dValue = (dxy*getSizeRatio())/(options.diameter)*properties.rangeValue;\n\t\t\tself.ambient_temperature = roundHalf(_drag.startTemperature+dValue);\n\t\t}\n\t\t\n\t\tsvg.addEventListener('mousedown',dragStart);\n\t\tsvg.addEventListener('touchstart',dragStart);\n\t\t\n\t\tsvg.addEventListener('mouseup',dragEnd);\n\t\tsvg.addEventListener('mouseleave',dragEnd);\n\t\tsvg.addEventListener('touchend',dragEnd);\n\t\t\n\t\tsvg.addEventListener('mousemove',dragMove);\n\t\tsvg.addEventListener('touchmove',dragMove);\n\t\t//\n\t\t\n\t\t/*\n\t\t * Helper functions\n\t\t */\n\t\tfunction restrictTargetTemperature(t) {\n\t\t\treturn restrictToRange(roundHalf(t),options.minValue,options.maxValue);\n\t\t}\n\t\t\n\t\tfunction angle(point) {\n\t\t\tvar dx = point[0] - properties.radius;\n\t\t\tvar dy = point[1] - properties.radius;\n\t\t\tvar theta = Math.atan(dx/dy) / (Math.PI/180);\n\t\t\tif (point[0]>=properties.radius && point[1] < properties.radius) {\n\t\t\t\ttheta = 90-theta - 90;\n\t\t\t} else if (point[0]>=properties.radius && point[1] >= properties.radius) {\n\t\t\t\ttheta = 90-theta + 90;\n\t\t\t} else if (point[0]<properties.radius && point[1] >= properties.radius) {\n\t\t\t\ttheta = 90-theta + 90;\n\t\t\t} else if (point[0]<properties.radius && point[1] < properties.radius) {\n\t\t\t\ttheta = 90-theta+270;\n\t\t\t}\n\t\t\treturn theta;\n\t\t};\n\t\t\n\t\tfunction getSizeRatio() {\n\t\t\treturn options.diameter / targetElement.clientWidth;\n\t\t}\n\t\t\n\t};\n})();\n\n/* ==== */\n(function(scope) {\n    \n    var nest = new thermostatDial(document.getElementById('thermostat'),{\n    \tonSetTargetTemperature: function(v) {\n    \t\tscope.send({topic: \"target_temperature\", payload: v});\n    \t}\n    });\n\n\n    scope.$watch('msg', function(data) {\n        //console.log(data.topic+\"  \"+data.payload);\n            nest.ambient_temperature = data.payload.temperature;\n            nest.target_temperature = data.payload.setpoint;\n            nest.hvac_state = data.payload.state;\n            nest.has_leaf = data.payload.leaf;\n            nest.away = data.payload.away;\n    });\n})(scope);\n\n</script>","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","x":550,"y":180,"wires":[[]]},{"id":"76cc1f59.55e19","type":"ui_text","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","order":11,"width":1,"height":2,"name":"Blank","label":"","format":"","layout":"row-spread","x":730,"y":60,"wires":[]},{"id":"542a290a.0c8878","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"Title","order":1,"width":6,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":40,"wires":[[]]},{"id":"18bde075.9ed0a","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"ACkWh","order":19,"width":3,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #FFE082;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#FFE082'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":560,"y":200,"wires":[[]]},{"id":"d9ef812b.16ecb","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"PVkWh","order":20,"width":3,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #C5E1A5;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#C5E1A5'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":560,"y":220,"wires":[[]]},{"id":"b817a8f2.d33ab8","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"ACcost","order":21,"width":3,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #FFE082;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#FFE082'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":560,"y":240,"wires":[[]]},{"id":"b111e9a2.22cf68","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"PVsave","order":22,"width":3,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #C5E1A5;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#C5E1A5'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":560,"y":260,"wires":[[]]},{"id":"26c99e60.78eda2","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"PV%","order":23,"width":3,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":280,"wires":[[]]},{"id":"87d62220.94665","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"CO2","order":24,"width":3,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":300,"wires":[[]]},{"id":"17fd996e.acedd7","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"Alarms","order":25,"width":6,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? '#E65100' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":560,"y":320,"wires":[[]]},{"id":"b29412eb.2b158","type":"inject","z":"e34d9a79.0942a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"0.3","topic":"","payload":"","payloadType":"date","x":120,"y":300,"wires":[["941c3db2.71986"]]},{"id":"b7edc5ab.45c778","type":"ui_text_input","z":"e34d9a79.0942a8","name":"","label":"AC Setpoint","tooltip":"","group":"f9e4a7e3.f06e58","order":5,"width":2,"height":1,"passthru":false,"mode":"number","delay":"0","topic":"","topicType":"str","x":570,"y":120,"wires":[["6beefe47.cd93e"]]},{"id":"a4c6d743.d93e48","type":"ui_text_input","z":"e34d9a79.0942a8","name":"","label":"Boost Setpoint","tooltip":"","group":"f9e4a7e3.f06e58","order":7,"width":2,"height":1,"passthru":false,"mode":"number","delay":"0","topic":"","topicType":"str","x":580,"y":140,"wires":[["29dc236b.41095c"]]},{"id":"71f88cc6.353694","type":"ui_text_input","z":"e34d9a79.0942a8","name":"","label":"PV Setpoint","tooltip":"","group":"f9e4a7e3.f06e58","order":6,"width":2,"height":1,"passthru":false,"mode":"number","delay":"0","topic":"","topicType":"str","x":570,"y":160,"wires":[["7ad3c472.479ccc"]]},{"id":"ad2174f0.916a68","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"AC I","order":26,"width":2,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":340,"wires":[[]]},{"id":"db03f60f.d9bcf8","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"PV I","order":27,"width":2,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":360,"wires":[[]]},{"id":"3c0e1495.1d4c7c","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"PCB","order":28,"width":2,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: black;\n                padding: 5px 5px;\n                text-align: left;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EEEEEE;\"\n            ng-style=\"{background: msg.payload == '1' ? '#E65100' : '#EEEEEE'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":380,"wires":[[]]},{"id":"fb791a38.ed9d38","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"AC","order":2,"width":2,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: white;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: grey;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : 'grey'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":60,"wires":[[]]},{"id":"f846227e.6a588","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"PV","order":3,"width":2,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: white;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: grey;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : 'grey'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":80,"wires":[[]]},{"id":"93ec014.fab52","type":"ui_template","z":"e34d9a79.0942a8","group":"f9e4a7e3.f06e58","name":"Boost","order":4,"width":2,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: white;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: grey;\"\n            ng-style=\"{background: msg.payload == '1' ? 'DeepSkyBlue' : 'grey'}\"\n            ng-bind-html=\"msg.text\"\n        >\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":550,"y":100,"wires":[[]]},{"id":"4420016b.6d177","type":"subflow:ebe4365e.c94b18","z":"e34d9a79.0942a8","name":"","env":[],"x":330,"y":240,"wires":[["542a290a.0c8878"],["fb791a38.ed9d38"],["f846227e.6a588"],["93ec014.fab52"],["b7edc5ab.45c778"],["a4c6d743.d93e48"],["71f88cc6.353694"],["a6560756.14e028"],["18bde075.9ed0a"],["d9ef812b.16ecb"],["b817a8f2.d33ab8"],["b111e9a2.22cf68"],["26c99e60.78eda2"],["87d62220.94665"],["17fd996e.acedd7"],["ad2174f0.916a68"],["db03f60f.d9bcf8"],["3c0e1495.1d4c7c"],["ffe06a5f.b89d08"],["21d38095.3df1f"],["726d5f59.4b47a"]]},{"id":"941c3db2.71986","type":"function","z":"e34d9a79.0942a8","name":"","func":"if(global.get(\"Dual\")===true)\n{\n    msg.payload = global.get(\"Geyser2Data\");\n    msg.cost = global.get(\"EskomRate\");\n    msg.text = global.get(\"Geyser2Name\");\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":160,"y":240,"wires":[["4420016b.6d177"]]},{"id":"ffe06a5f.b89d08","type":"ui_switch","z":"e34d9a79.0942a8","name":"","label":"AC","tooltip":"Enable AC Usage","group":"f9e4a7e3.f06e58","order":8,"width":2,"height":1,"passthru":false,"decouple":"true","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square fa-2x","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o fa-2x","offcolor":"grey","animate":true,"x":550,"y":400,"wires":[["4fc59c3a.44dfd4"]]},{"id":"21d38095.3df1f","type":"ui_switch","z":"e34d9a79.0942a8","name":"","label":"Boost","tooltip":"","group":"f9e4a7e3.f06e58","order":9,"width":2,"height":1,"passthru":false,"decouple":"true","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square fa-2x","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o fa-2x","offcolor":"grey","animate":true,"x":550,"y":420,"wires":[["f46cef83.00edb"]]},{"id":"726d5f59.4b47a","type":"ui_switch","z":"e34d9a79.0942a8","name":"","label":"PV","tooltip":"","group":"f9e4a7e3.f06e58","order":10,"width":2,"height":1,"passthru":false,"decouple":"true","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square fa-2x","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o fa-2x","offcolor":"grey","animate":true,"x":550,"y":440,"wires":[["c3c318f1.10aa28"]]},{"id":"5c93a61e.fe0c78","type":"ui_button","z":"e34d9a79.0942a8","name":"","group":"f9e4a7e3.f06e58","order":30,"width":4,"height":1,"passthru":false,"label":"Reset","tooltip":"","color":"","bgcolor":"grey","icon":"","payload":"","payloadType":"str","topic":"","topicType":"str","x":550,"y":460,"wires":[["aee33132.ead81"]]},{"id":"c7061bd4.2ae5d8","type":"link in","z":"e34d9a79.0942a8","name":"Dashboard Update","links":["64ee53dd.bd4cdc"],"x":155,"y":340,"wires":[["941c3db2.71986"]]},{"id":"19b79b05.2b1ec5","type":"ui_button","z":"e34d9a79.0942a8","name":"Refresh","group":"f9e4a7e3.f06e58","order":31,"width":2,"height":1,"passthru":false,"label":"","tooltip":"Refresh Data","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"topic","topicType":"str","x":560,"y":480,"wires":[["e848606e.0ad76"]]},{"id":"e848606e.0ad76","type":"link out","z":"e34d9a79.0942a8","name":"Refresh","links":["27754038.b50a4","e35e7978.1493b8"],"x":675,"y":480,"wires":[]},{"id":"d6cd4f90.d3beb","type":"ui_chart","z":"e34d9a79.0942a8","name":"","group":"8658851b.0540b8","order":1,"width":0,"height":0,"label":"Geyser Data","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"monotone","nodata":"","dot":false,"ymin":"0","ymax":"80","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":570,"y":580,"wires":[[]]},{"id":"db357188.861cb","type":"function","z":"e34d9a79.0942a8","name":"Temperature","func":"if(global.get(\"Dual\")===true)\n{\n    var data = global.get(\"Geyser2Data\");\n    var temp = parseFloat(data.Analog.T.G);\n    msg.payload = temp.toFixed(1);\n    msg.topic = \"Geyser Temperature\"\n    return msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":390,"y":560,"wires":[["d6cd4f90.d3beb"]]},{"id":"b7e2cd74.7e087","type":"function","z":"e34d9a79.0942a8","name":"PCB","func":"if(global.get(\"Dual\")===true)\n{\n    var data = global.get(\"Geyser2Data\");\n    var temp = parseFloat(data.Analog.T.PCB);\n    msg.payload = temp.toFixed(1);\n    msg.topic = \"PCB Temperature\"\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":370,"y":580,"wires":[["d6cd4f90.d3beb"]]},{"id":"ad909ee5.0dc25","type":"complete","z":"e34d9a79.0942a8","name":"","scope":["bb77abdd.f90ea8"],"uncaught":false,"x":550,"y":520,"wires":[["e848606e.0ad76"]]},{"id":"63769955.55aac8","type":"inject","z":"e34d9a79.0942a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":560,"wires":[["db357188.861cb","b7e2cd74.7e087"]]},{"id":"afc13cc2.9ef6f","type":"comment","z":"e34d9a79.0942a8","name":"Enable Timers","info":"","x":130,"y":660,"wires":[]},{"id":"7a15d16d.ca0f4","type":"function","z":"e34d9a79.0942a8","name":"","func":"if(global.get(\"Dual\")===true)\n{\n    var data = global.get(\"Geyser2Data\");\n    msg.payload = data.Timers.C;\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":300,"y":700,"wires":[["5e6fe518.1854ac"]]},{"id":"5e6fe518.1854ac","type":"ui_switch","z":"e34d9a79.0942a8","name":"","label":"Timers Enabled","tooltip":"","group":"f9e4a7e3.f06e58","order":29,"width":"0","height":"0","passthru":true,"decouple":"false","topic":"topic","topicType":"msg","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-window-close","offcolor":"grey","animate":true,"x":480,"y":700,"wires":[["5e95ed02.097204"]]},{"id":"fb88a148.2a925","type":"link in","z":"e34d9a79.0942a8","name":"","links":["f1624e6d.2dd26"],"x":195,"y":700,"wires":[["7a15d16d.ca0f4"]]},{"id":"a7c329d4.dc2058","type":"ui_button","z":"1d8af5ee.d9dbda","name":"","group":"3eed1d59.f985d2","order":13,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":90,"y":60,"wires":[["e72dee74.83672"]]},{"id":"e72dee74.83672","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var data = global.get(\"Geyser2Data\");\n\nmsg.payload = {\n    \"C\":data.Timer1.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer1.S.h),\n        \"m\": parseInt(data.Timer1.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer1.E.h),\n        \"m\": parseInt(data.Timer1.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer1.W.Mo,\n        \"Tu\": data.Timer1.W.Tu,\n        \"We\": data.Timer1.W.We,\n        \"Th\": data.Timer1.W.Th,\n        \"Fr\": data.Timer1.W.Fr,\n        \"Sa\": data.Timer1.W.Sa,\n        \"Su\": data.Timer1.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":220,"y":60,"wires":[["f3068b7c.69c228"]]},{"id":"f3068b7c.69c228","type":"json","z":"1d8af5ee.d9dbda","name":"","property":"payload","action":"","pretty":false,"x":370,"y":60,"wires":[["d076d7c8.ec5ec8"]]},{"id":"a78dd14.0b1113","type":"ui_button","z":"1d8af5ee.d9dbda","name":"","group":"3eed1d59.f985d2","order":27,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":90,"y":100,"wires":[["4b166565.8588fc"]]},{"id":"4b166565.8588fc","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var data = global.get(\"Geyser2Data\");\n\nmsg.payload = {\n    \"C\":data.Timer2.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer2.S.h),\n        \"m\": parseInt(data.Timer2.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer2.E.h),\n        \"m\": parseInt(data.Timer2.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer2.W.Mo,\n        \"Tu\": data.Timer2.W.Tu,\n        \"We\": data.Timer2.W.We,\n        \"Th\": data.Timer2.W.Th,\n        \"Fr\": data.Timer2.W.Fr,\n        \"Sa\": data.Timer2.W.Sa,\n        \"Su\": data.Timer2.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":220,"y":100,"wires":[["f80d1a41.a06468"]]},{"id":"f80d1a41.a06468","type":"json","z":"1d8af5ee.d9dbda","name":"","property":"payload","action":"","pretty":false,"x":370,"y":100,"wires":[["46f6547b.11f8fc"]]},{"id":"f0cfa136.3a7a6","type":"ui_button","z":"1d8af5ee.d9dbda","name":"","group":"3eed1d59.f985d2","order":41,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":90,"y":140,"wires":[["37e85c7f.1dde44"]]},{"id":"37e85c7f.1dde44","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var data = global.get(\"Geyser2Data\");\n\nmsg.payload = {\n    \"C\":data.Timer3.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer3.S.h),\n        \"m\": parseInt(data.Timer3.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer3.E.h),\n        \"m\": parseInt(data.Timer3.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer3.W.Mo,\n        \"Tu\": data.Timer3.W.Tu,\n        \"We\": data.Timer3.W.We,\n        \"Th\": data.Timer3.W.Th,\n        \"Fr\": data.Timer3.W.Fr,\n        \"Sa\": data.Timer3.W.Sa,\n        \"Su\": data.Timer3.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":220,"y":140,"wires":[["cf9068e0.b98b28"]]},{"id":"cf9068e0.b98b28","type":"json","z":"1d8af5ee.d9dbda","name":"","property":"payload","action":"","pretty":false,"x":370,"y":140,"wires":[["e931e008.ece44"]]},{"id":"a5f073c5.13cc4","type":"ui_button","z":"1d8af5ee.d9dbda","name":"","group":"3eed1d59.f985d2","order":55,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Save Settings","color":"","bgcolor":"","icon":"fa-floppy-o fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":90,"y":180,"wires":[["28637c84.de41f4"]]},{"id":"28637c84.de41f4","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var data = global.get(\"Geyser2Data\");\n\nmsg.payload = {\n    \"C\":data.Timer4.C,\n    \"S\": {\n        \"h\": parseInt(data.Timer4.S.h),\n        \"m\": parseInt(data.Timer4.S.m)\n    },\n    \"E\": {\n        \"h\": parseInt(data.Timer4.E.h),\n        \"m\": parseInt(data.Timer4.E.m)\n    },\n    \"W\": {\n        \"Mo\": data.Timer4.W.Mo,\n        \"Tu\": data.Timer4.W.Tu,\n        \"We\": data.Timer4.W.We,\n        \"Th\": data.Timer4.W.Th,\n        \"Fr\": data.Timer4.W.Fr,\n        \"Sa\": data.Timer4.W.Sa,\n        \"Su\": data.Timer4.W.Su,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":220,"y":180,"wires":[["cdd1a8e6.1a3218"]]},{"id":"cdd1a8e6.1a3218","type":"json","z":"1d8af5ee.d9dbda","name":"","property":"payload","action":"","pretty":false,"x":370,"y":180,"wires":[["411589de.63bf58"]]},{"id":"dca1e884.91d4f8","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Enable","tooltip":"","group":"3eed1d59.f985d2","order":2,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"T1Enable","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":620,"y":340,"wires":[["45d483af.becc0c"]]},{"id":"ebd1cf4f.8f929","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Mo","tooltip":"Monday","group":"3eed1d59.f985d2","order":6,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":360,"wires":[["45d483af.becc0c"]]},{"id":"7b459e98.f","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Tu","tooltip":"Tuesday","group":"3eed1d59.f985d2","order":7,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":380,"wires":[["45d483af.becc0c"]]},{"id":"b0321a41.9bd568","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"We","tooltip":"Wednesday","group":"3eed1d59.f985d2","order":8,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":400,"wires":[["45d483af.becc0c"]]},{"id":"9ae810a3.a4fbc","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Th","tooltip":"Thursday","group":"3eed1d59.f985d2","order":9,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":420,"wires":[["45d483af.becc0c"]]},{"id":"db7ec5e3.6e35c8","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Fr","tooltip":"Friday","group":"3eed1d59.f985d2","order":10,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":440,"wires":[["45d483af.becc0c"]]},{"id":"a89969d2.769f68","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Sa","tooltip":"Saturday","group":"3eed1d59.f985d2","order":11,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":460,"wires":[["45d483af.becc0c"]]},{"id":"1f7ec4da.13239b","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Su","tooltip":"Sunday","group":"3eed1d59.f985d2","order":12,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":480,"wires":[["45d483af.becc0c"]]},{"id":"cbf89cf8.72db6","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"On","tooltip":"On Time","group":"3eed1d59.f985d2","order":3,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":610,"y":500,"wires":[["45d483af.becc0c"]]},{"id":"b540cec3.d8b85","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"Off","tooltip":"Off Time","group":"3eed1d59.f985d2","order":4,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":610,"y":520,"wires":[["45d483af.becc0c"]]},{"id":"c1f1a9f1.be2f88","type":"ui_button","z":"1d8af5ee.d9dbda","name":"Refresh","group":"3eed1d59.f985d2","order":14,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":100,"y":340,"wires":[["ae61b7ba.da87d8","9e7ab32a.71553"]]},{"id":"b2d4533c.fa118","type":"comment","z":"1d8af5ee.d9dbda","name":"Timer 1","info":"","x":90,"y":300,"wires":[]},{"id":"ae61b7ba.da87d8","type":"link out","z":"1d8af5ee.d9dbda","name":"TimersRefresh","links":["8a0739ce.533a78"],"x":235,"y":340,"wires":[]},{"id":"e57ee7f3.b09b18","type":"inject","z":"1d8af5ee.d9dbda","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":380,"wires":[["9e7ab32a.71553"]]},{"id":"34e596db.17418a","type":"ui_button","z":"1d8af5ee.d9dbda","name":"Refresh","group":"3eed1d59.f985d2","order":28,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":100,"y":800,"wires":[["e04893e1.63fe4"]]},{"id":"f82e5632.2df6c8","type":"comment","z":"1d8af5ee.d9dbda","name":"Timer 2","info":"","x":90,"y":680,"wires":[]},{"id":"14c419c.0e820e6","type":"inject","z":"1d8af5ee.d9dbda","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":840,"wires":[["e04893e1.63fe4"]]},{"id":"bac3d087.88b36","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Enable","tooltip":"","group":"3eed1d59.f985d2","order":16,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":620,"y":720,"wires":[["e50f4c94.c1cf5"]]},{"id":"31e89715.9ccf28","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Mo","tooltip":"Monday","group":"3eed1d59.f985d2","order":20,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":740,"wires":[["a865bea8.c17b4"]]},{"id":"8eecf20c.00f31","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Tu","tooltip":"Tuesday","group":"3eed1d59.f985d2","order":21,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":760,"wires":[["68e2144b.a89fbc"]]},{"id":"7abef5b.989620c","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"We","tooltip":"Wednesday","group":"3eed1d59.f985d2","order":22,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":780,"wires":[["bbdb56f6.fd5d38"]]},{"id":"e4d37581.09dde8","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Th","tooltip":"Thursday","group":"3eed1d59.f985d2","order":23,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":800,"wires":[["90929e87.c6d87"]]},{"id":"2bcf2b92.43b264","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Fr","tooltip":"Friday","group":"3eed1d59.f985d2","order":24,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":820,"wires":[["fd6f1bac.501d98"]]},{"id":"2c20a1c7.4d0ffe","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Sa","tooltip":"Saturday","group":"3eed1d59.f985d2","order":25,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":840,"wires":[["9b9519ed.35bee8"]]},{"id":"fb972ff8.f5b57","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Su","tooltip":"Sunday","group":"3eed1d59.f985d2","order":26,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":610,"y":860,"wires":[["3435f8a6.6b5d78"]]},{"id":"b60208c3.b5d828","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"On","tooltip":"On Time","group":"3eed1d59.f985d2","order":17,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":610,"y":880,"wires":[["30b0cf3e.f0428"]]},{"id":"195e7caa.7d9c63","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"Off","tooltip":"Off Time","group":"3eed1d59.f985d2","order":18,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":610,"y":900,"wires":[["b6b7a964.ae81b8"]]},{"id":"e50f4c94.c1cf5","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.C = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":720,"wires":[[]]},{"id":"a865bea8.c17b4","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.W.Mo = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":740,"wires":[[]]},{"id":"68e2144b.a89fbc","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.W.Tu = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":760,"wires":[[]]},{"id":"bbdb56f6.fd5d38","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.W.We = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":780,"wires":[[]]},{"id":"90929e87.c6d87","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.W.Th = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":800,"wires":[[]]},{"id":"fd6f1bac.501d98","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.W.Fr = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":820,"wires":[[]]},{"id":"9b9519ed.35bee8","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.W.Sa = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":840,"wires":[[]]},{"id":"3435f8a6.6b5d78","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer2.W.Su = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":860,"wires":[[]]},{"id":"30b0cf3e.f0428","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer2.S.h = hour;\npayload.Timer2.S.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":880,"wires":[[]]},{"id":"b6b7a964.ae81b8","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer2.E.h = hour;\npayload.Timer2.E.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":900,"wires":[[]]},{"id":"a885285d.5b9528","type":"ui_template","z":"1d8af5ee.d9dbda","group":"3eed1d59.f985d2","name":"Timer 1","order":1,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 1\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":620,"y":300,"wires":[[]]},{"id":"1205f819.5ce628","type":"ui_template","z":"1d8af5ee.d9dbda","group":"3eed1d59.f985d2","name":"Timer 2","order":15,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 2\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":620,"y":680,"wires":[[]]},{"id":"8357fcfb.3a81","type":"ui_button","z":"1d8af5ee.d9dbda","name":"Refresh","group":"3eed1d59.f985d2","order":42,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":1040,"wires":[["ad394619.8c9f28"]]},{"id":"5324948b.4ac3ac","type":"comment","z":"1d8af5ee.d9dbda","name":"Timer 3","info":"","x":90,"y":1000,"wires":[]},{"id":"4aa95d36.6a1174","type":"inject","z":"1d8af5ee.d9dbda","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":1080,"wires":[["ad394619.8c9f28"]]},{"id":"b50b5d59.5825","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Enable","tooltip":"","group":"3eed1d59.f985d2","order":30,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":560,"y":1080,"wires":[["629c570a.ef2598"]]},{"id":"579af551.197a8c","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Mo","tooltip":"Monday","group":"3eed1d59.f985d2","order":34,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1100,"wires":[["fff678a3.4adac8"]]},{"id":"ea070011.43ab8","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Tu","tooltip":"Tuesday","group":"3eed1d59.f985d2","order":35,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1120,"wires":[["d2442e9e.8a5b4"]]},{"id":"5ebb571.e651ca8","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"We","tooltip":"Wednesday","group":"3eed1d59.f985d2","order":36,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1140,"wires":[["379dd635.278fea"]]},{"id":"e895960f.0a1398","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Th","tooltip":"Thursday","group":"3eed1d59.f985d2","order":37,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1160,"wires":[["6b89bb1d.34d8e4"]]},{"id":"3cde53a4.032e5c","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Fr","tooltip":"Friday","group":"3eed1d59.f985d2","order":38,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1180,"wires":[["afeb5de8.4e525"]]},{"id":"a7b456e8.583e68","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Sa","tooltip":"Saturday","group":"3eed1d59.f985d2","order":39,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1200,"wires":[["9210b8ad.5267d8"]]},{"id":"b800b22.c907e5","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Su","tooltip":"Sunday","group":"3eed1d59.f985d2","order":40,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1220,"wires":[["7b102a8e.5c9204"]]},{"id":"641a8790.f8fe08","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"On","tooltip":"On Time","group":"3eed1d59.f985d2","order":31,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":550,"y":1240,"wires":[["3878db7.0856d24"]]},{"id":"c5bf7d54.85cce","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"Off","tooltip":"Off Time","group":"3eed1d59.f985d2","order":32,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":550,"y":1260,"wires":[["87057559.e304f8"]]},{"id":"ad394619.8c9f28","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.data = global.get(\"Geyser2Data\");\nmsg.payload = msg.data.Timer3.C;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1080,"wires":[["3b7cc4a8.ba1a3c","b50b5d59.5825"]]},{"id":"3b7cc4a8.ba1a3c","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer3.W.Mo;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1100,"wires":[["959a5208.299cd","579af551.197a8c"]]},{"id":"959a5208.299cd","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer3.W.Tu;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1120,"wires":[["4861ecd4.ec31f4","ea070011.43ab8"]]},{"id":"b7e1e632.566d98","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer3.W.Th;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1160,"wires":[["313e6b9e.4afee4","e895960f.0a1398"]]},{"id":"4861ecd4.ec31f4","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer3.W.We;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1140,"wires":[["b7e1e632.566d98","5ebb571.e651ca8"]]},{"id":"313e6b9e.4afee4","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer3.W.Fr;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1180,"wires":[["c2d89b77.4b6898","3cde53a4.032e5c"]]},{"id":"c2d89b77.4b6898","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer3.W.Sa;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1200,"wires":[["fa17ae13.e836c","a7b456e8.583e68"]]},{"id":"fa17ae13.e836c","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer3.W.Su;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1220,"wires":[["2b7bd428.3e7e5c","b800b22.c907e5"]]},{"id":"2b7bd428.3e7e5c","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var system_Hour     = msg.data.Timer3.S.h;\nvar system_Minute   = msg.data.Timer3.S.m;\n\nvar d = new Date(), e = new Date(d);\nvar msSinceMidnight = e.setHours(system_Hour,system_Minute,0,0) - d.setHours(0,0,0,0);\n\nif(system_Hour.toString().length == 1)   { system_Hour = '0'+system_Hour;}\nif(system_Minute.toString().length == 1) { system_Minute = '0'+system_Minute;}\n\nvar time = system_Hour + \":\" + system_Minute + \":00\";\nmsg.time = time;\nmsg.payload = msSinceMidnight;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1240,"wires":[["cccf103b.79365","641a8790.f8fe08"]]},{"id":"cccf103b.79365","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var system_Hour     = msg.data.Timer3.E.h;\nvar system_Minute   = msg.data.Timer3.E.m;\n\nvar d = new Date(), e = new Date(d);\nvar msSinceMidnight = e.setHours(system_Hour,system_Minute,0,0) - d.setHours(0,0,0,0);\n\nif(system_Hour.toString().length == 1)   { system_Hour = '0'+system_Hour;}\nif(system_Minute.toString().length == 1) { system_Minute = '0'+system_Minute;}\n\nvar time = system_Hour + \":\" + system_Minute + \":00\";\nmsg.time = time;\nmsg.payload = msSinceMidnight;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1260,"wires":[["c5bf7d54.85cce"]]},{"id":"629c570a.ef2598","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.C = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1080,"wires":[[]]},{"id":"fff678a3.4adac8","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.W.Mo = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1100,"wires":[[]]},{"id":"d2442e9e.8a5b4","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.W.Tu = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1120,"wires":[[]]},{"id":"379dd635.278fea","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.W.We = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1140,"wires":[[]]},{"id":"6b89bb1d.34d8e4","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.W.Th = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1160,"wires":[[]]},{"id":"afeb5de8.4e525","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.W.Fr = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1180,"wires":[[]]},{"id":"9210b8ad.5267d8","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.W.Sa = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1200,"wires":[[]]},{"id":"7b102a8e.5c9204","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer3.W.Su = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1220,"wires":[[]]},{"id":"3878db7.0856d24","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer3.S.h = hour;\npayload.Timer3.S.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1240,"wires":[[]]},{"id":"87057559.e304f8","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer3.E.h = hour;\npayload.Timer3.E.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1260,"wires":[[]]},{"id":"6efb1dd5.845394","type":"ui_template","z":"1d8af5ee.d9dbda","group":"3eed1d59.f985d2","name":"Timer 3","order":29,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 3\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":560,"y":1040,"wires":[[]]},{"id":"16dfc7ff.2cd758","type":"ui_button","z":"1d8af5ee.d9dbda","name":"Refresh","group":"3eed1d59.f985d2","order":56,"width":1,"height":1,"passthru":false,"label":"","tooltip":"Refresh","color":"","bgcolor":"","icon":"fa-refresh fa-2x","payload":"","payloadType":"str","topic":"","topicType":"str","x":120,"y":1420,"wires":[["57e10eaf.acb6f"]]},{"id":"d1ca6d54.0b4c6","type":"comment","z":"1d8af5ee.d9dbda","name":"Timer 4","info":"","x":90,"y":1380,"wires":[]},{"id":"865b9083.16579","type":"inject","z":"1d8af5ee.d9dbda","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":1460,"wires":[["57e10eaf.acb6f"]]},{"id":"3bb338d9.0a2a88","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Enable","tooltip":"","group":"3eed1d59.f985d2","order":44,"width":2,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"green","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"grey","animate":true,"x":560,"y":1460,"wires":[["24f187aa.02d118"]]},{"id":"d1630ed9.468de","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Mo","tooltip":"Monday","group":"3eed1d59.f985d2","order":48,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1480,"wires":[["4e8ef14c.73703"]]},{"id":"402ce356.b9132c","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Tu","tooltip":"Tuesday","group":"3eed1d59.f985d2","order":50,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1500,"wires":[["26fe3099.dbe87"]]},{"id":"67acafee.5e68f","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"We","tooltip":"Wednesday","group":"3eed1d59.f985d2","order":49,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1520,"wires":[["90b287f1.f43198"]]},{"id":"39c9b83d.5a04f8","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Th","tooltip":"Thursday","group":"3eed1d59.f985d2","order":51,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1540,"wires":[["51a2767.a87be88"]]},{"id":"d9c5190f.667ea8","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Fr","tooltip":"Friday","group":"3eed1d59.f985d2","order":52,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1560,"wires":[["eedc737.7b6d19"]]},{"id":"d79d746f.4bad58","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Sa","tooltip":"Saturday","group":"3eed1d59.f985d2","order":53,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1580,"wires":[["9d15912e.27d37"]]},{"id":"5569e17.189232","type":"ui_switch","z":"1d8af5ee.d9dbda","name":"","label":"Su","tooltip":"Sunday","group":"3eed1d59.f985d2","order":54,"width":1,"height":1,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"1","onvalueType":"num","onicon":"fa-check-square-o","oncolor":"--nr-dashboard-widgetTextColor","offvalue":"0","offvalueType":"num","officon":"fa-square-o","offcolor":"--nr-dashboard-widgetTextColor","animate":true,"x":550,"y":1600,"wires":[["993d8415.f1fa18"]]},{"id":"898c86b7.047ec8","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"On","tooltip":"On Time","group":"3eed1d59.f985d2","order":45,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":550,"y":1620,"wires":[["29008a5b.283a16"]]},{"id":"89efc40a.e145f8","type":"ui_text_input","z":"1d8af5ee.d9dbda","name":"","label":"Off","tooltip":"Off Time","group":"3eed1d59.f985d2","order":46,"width":3,"height":1,"passthru":true,"mode":"time","delay":"0","topic":"","topicType":"str","x":550,"y":1640,"wires":[["1cca175a.d1b7e9"]]},{"id":"57e10eaf.acb6f","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.data = global.get(\"Geyser2Data\");\nmsg.payload = msg.data.Timer4.C;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1460,"wires":[["657d3f77.81b84","3bb338d9.0a2a88"]]},{"id":"657d3f77.81b84","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer4.W.Mo;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1480,"wires":[["373e3a0c.0ce6c6","d1630ed9.468de"]]},{"id":"373e3a0c.0ce6c6","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer4.W.Tu;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1500,"wires":[["a4b70ea9.c1406","402ce356.b9132c"]]},{"id":"c73bb72b.29fb38","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer4.W.Th;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1540,"wires":[["40b55247.32fefc","39c9b83d.5a04f8"]]},{"id":"a4b70ea9.c1406","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer4.W.We;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1520,"wires":[["c73bb72b.29fb38","67acafee.5e68f"]]},{"id":"40b55247.32fefc","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer4.W.Fr;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1560,"wires":[["b24b1aac.e01d88","d9c5190f.667ea8"]]},{"id":"b24b1aac.e01d88","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer4.W.Sa;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1580,"wires":[["95e252ce.a2e49","d79d746f.4bad58"]]},{"id":"95e252ce.a2e49","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"msg.payload = msg.data.Timer4.W.Su;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1600,"wires":[["3ffde231.69755e","5569e17.189232"]]},{"id":"3ffde231.69755e","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var system_Hour     = msg.data.Timer4.S.h;\nvar system_Minute   = msg.data.Timer4.S.m;\n\nvar d = new Date(), e = new Date(d);\nvar msSinceMidnight = e.setHours(system_Hour,system_Minute,0,0) - d.setHours(0,0,0,0);\n\nif(system_Hour.toString().length == 1)   { system_Hour = '0'+system_Hour;}\nif(system_Minute.toString().length == 1) { system_Minute = '0'+system_Minute;}\n\nvar time = system_Hour + \":\" + system_Minute + \":00\";\nmsg.time = time;\nmsg.payload = msSinceMidnight;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1620,"wires":[["cf9ffccb.30926","898c86b7.047ec8"]]},{"id":"cf9ffccb.30926","type":"function","z":"1d8af5ee.d9dbda","name":"","func":"var system_Hour     = msg.data.Timer4.E.h;\nvar system_Minute   = msg.data.Timer4.E.m;\n\nvar d = new Date(), e = new Date(d);\nvar msSinceMidnight = e.setHours(system_Hour,system_Minute,0,0) - d.setHours(0,0,0,0);\n\nif(system_Hour.toString().length == 1)   { system_Hour = '0'+system_Hour;}\nif(system_Minute.toString().length == 1) { system_Minute = '0'+system_Minute;}\n\nvar time = system_Hour + \":\" + system_Minute + \":00\";\nmsg.time = time;\nmsg.payload = msSinceMidnight;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":1640,"wires":[["89efc40a.e145f8"]]},{"id":"24f187aa.02d118","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.C = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1460,"wires":[[]]},{"id":"4e8ef14c.73703","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.W.Mo = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1480,"wires":[[]]},{"id":"26fe3099.dbe87","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.W.Tu = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1500,"wires":[[]]},{"id":"90b287f1.f43198","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.W.We = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1520,"wires":[[]]},{"id":"51a2767.a87be88","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.W.Th = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1540,"wires":[[]]},{"id":"eedc737.7b6d19","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.W.Fr = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1560,"wires":[[]]},{"id":"9d15912e.27d37","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.W.Sa = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1580,"wires":[[]]},{"id":"993d8415.f1fa18","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\npayload.Timer4.W.Su = msg.payload;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1600,"wires":[[]]},{"id":"29008a5b.283a16","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer4.S.h = hour;\npayload.Timer4.S.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1620,"wires":[[]]},{"id":"1cca175a.d1b7e9","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\nvar time = new Date(msg.payload);\nvar hour = time.getUTCHours();\nvar min = time.getMinutes();\n\npayload.Timer4.E.h = hour;\npayload.Timer4.E.m = min;\nmsg.payload = hour + \":\" + min;\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1640,"wires":[[]]},{"id":"a028612c.25a53","type":"ui_template","z":"1d8af5ee.d9dbda","group":"3eed1d59.f985d2","name":"Timer 4","order":43,"width":9,"height":1,"format":"<!DOCTYPE html>\n<html>\n    <body>\n        <div \n            style=\n                \"border: none;\n                color: #273746;\n                padding: 5px 5px;\n                text-align: center;\n                text-decoration: none;\n                display: inline-block;\n                font-size: 14px;\n                font-weight: bold;\n                margin: 0px;\n                border-radius: 6px;\n                background-color: #EAECEE;\"\n            ng-style=\"{background: #EAECEE}\"\n        > Timer 4\n        </div>\n    </body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":560,"y":1420,"wires":[[]]},{"id":"add82985.1b6308","type":"function","z":"65f07aa6.9889a4","name":"Enable","func":"msg.payload = msg.data.C;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":80,"wires":[["3978633e.a0480c"]]},{"id":"3978633e.a0480c","type":"function","z":"65f07aa6.9889a4","name":"Monday","func":"msg.payload = msg.data.W.Mo;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":120,"wires":[["efe448f6.98abd8"]]},{"id":"efe448f6.98abd8","type":"function","z":"65f07aa6.9889a4","name":"Tuesday","func":"msg.payload = msg.data.W.Tu;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":160,"wires":[["3851122a.10345e"]]},{"id":"c3110e2b.578c1","type":"function","z":"65f07aa6.9889a4","name":"Thursday","func":"msg.payload = msg.data.W.Th;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":240,"wires":[["94ace4e0.445df8"]]},{"id":"3851122a.10345e","type":"function","z":"65f07aa6.9889a4","name":"Wednesday","func":"msg.payload = msg.data.W.We;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":190,"y":200,"wires":[["c3110e2b.578c1"]]},{"id":"94ace4e0.445df8","type":"function","z":"65f07aa6.9889a4","name":"Friday","func":"msg.payload = msg.data.W.Fr;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":170,"y":280,"wires":[["fc65d0a1.347a4"]]},{"id":"fc65d0a1.347a4","type":"function","z":"65f07aa6.9889a4","name":"Saturday","func":"msg.payload = msg.data.W.Sa;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":320,"wires":[["61890613.1e8358"]]},{"id":"61890613.1e8358","type":"function","z":"65f07aa6.9889a4","name":"Sunday","func":"msg.payload = msg.data.W.Su;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":360,"wires":[["7c0ed9c4.487458"]]},{"id":"7c0ed9c4.487458","type":"function","z":"65f07aa6.9889a4","name":"On Time","func":"var system_Hour     = msg.data.S.h;\nvar system_Minute   = msg.data.S.m;\n\nvar d = new Date(), e = new Date(d);\nvar msSinceMidnight = e.setHours(system_Hour,system_Minute,0,0) - d.setHours(0,0,0,0);\n\nif(system_Hour.toString().length == 1)   { system_Hour = '0'+system_Hour;}\nif(system_Minute.toString().length == 1) { system_Minute = '0'+system_Minute;}\n\nvar time = system_Hour + \":\" + system_Minute + \":00\";\nmsg.time = time;\nmsg.payload = msSinceMidnight;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":400,"wires":[["664ecef8.2bf12"]]},{"id":"664ecef8.2bf12","type":"function","z":"65f07aa6.9889a4","name":"Off Time","func":"var system_Hour     = msg.data.E.h;\nvar system_Minute   = msg.data.E.m;\n\nvar d = new Date(), e = new Date(d);\nvar msSinceMidnight = e.setHours(system_Hour,system_Minute,0,0) - d.setHours(0,0,0,0);\n\nif(system_Hour.toString().length == 1)   { system_Hour = '0'+system_Hour;}\nif(system_Minute.toString().length == 1) { system_Minute = '0'+system_Minute;}\n\nvar time = system_Hour + \":\" + system_Minute + \":00\";\nmsg.time = time;\nmsg.payload = msSinceMidnight;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":440,"wires":[[]]},{"id":"8111e40b.4ef538","type":"function","z":"65f07aa6.9889a4","name":"Off Time","func":"if(msg.data.C == 0)\n{\n    msg.payload = \"Timer Disabled\";\n}\nelse\n{\n    msg.payload = \"Timer Enabled\"\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":40,"wires":[[]]},{"id":"34c7ab73.eadd34","type":"subflow:65f07aa6.9889a4","z":"90588a53.b682a8","name":"Timer 1","env":[],"x":520,"y":360,"wires":[["4a204b0f.313564"],["30d3924e.a45efe"],["41d4a877.0cc3d8"],["280e68b2.eac5c8"],["bafc57a6.924aa8"],["7d8565df.70a1cc"],["1656fba3.48fdf4"],["f5ae693d.05d6e8"],["42ab1143.65392"],["817f4a6d.7353b8"]]},{"id":"ba303cb1.ef8c2","type":"function","z":"90588a53.b682a8","name":"Timer 1","func":"var payload = global.get(\"Geyser1Data\");\nmsg.data = payload.Timer1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":360,"wires":[["34c7ab73.eadd34"]]},{"id":"33dc17a4.445928","type":"subflow:65f07aa6.9889a4","z":"90588a53.b682a8","name":"Timer 2","env":[],"x":530,"y":640,"wires":[["ab850b29.9fbec8"],["2c53c031.c96"],["c128f68e.3bd3e8"],["4b17b54d.8ed33c"],["b0a4c875.86f8a8"],["7090d116.d712e"],["7f59257f.5b5f0c"],["7773e12.7623c2"],["c419cf78.abb63"],["692b7755.22a3f8"]]},{"id":"d52768e2.84ff78","type":"function","z":"90588a53.b682a8","name":"Timer 2","func":"var payload = global.get(\"Geyser1Data\");\nmsg.data = payload.Timer2;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400,"y":640,"wires":[["33dc17a4.445928"]]},{"id":"e68d93f7.085a6","type":"subflow:65f07aa6.9889a4","z":"90588a53.b682a8","name":"Timer 3","env":[],"x":530,"y":920,"wires":[["b6941d14.a6d12"],["c8a362b9.a3b46"],["23f814bc.7ab05c"],["6e73d70a.e33578"],["37abc4f5.08976c"],["fee2354e.753268"],["c0fc7013.aacdf"],["fe4ee380.a324e"],["b798f112.9d62d"],["f1177971.9186c8"]]},{"id":"480311dd.b7a44","type":"function","z":"90588a53.b682a8","name":"Timer 3","func":"var payload = global.get(\"Geyser1Data\");\nmsg.data = payload.Timer3;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400,"y":920,"wires":[["e68d93f7.085a6"]]},{"id":"f5add3ed.42d99","type":"subflow:65f07aa6.9889a4","z":"90588a53.b682a8","name":"Timer 4","env":[],"x":530,"y":1200,"wires":[["1279d59e.2315ca"],["84f4a5ba.7a0298"],["3b85c35a.d66a6c"],["4faf57e2.6d2e08"],["a0277da8.7b7ea"],["875526d2.33a1b8"],["2054bc0f.2d9514"],["e126848c.6d7528"],["7ef5717f.8f5d8"],["7d31b1c6.46e5d"]]},{"id":"d1493c64.761d6","type":"function","z":"90588a53.b682a8","name":"Timer 4","func":"var payload = global.get(\"Geyser1Data\");\nmsg.data = payload.Timer4;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400,"y":1200,"wires":[["f5add3ed.42d99"]]},{"id":"ff8ab3f7.28c5b","type":"json","z":"3dddaeea.f4e652","name":"","property":"payload","action":"","pretty":false,"x":610,"y":80,"wires":[["78fc320c.8e251c"]]},{"id":"1acdcccc.cbb883","type":"debug","z":"3dddaeea.f4e652","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":890,"y":80,"wires":[]},{"id":"19d6ecab.3811a3","type":"mqtt-in-dynamicsub","z":"3dddaeea.f4e652","name":"","qos":"0","datatype":"auto","unsubscribe-after-first-msg-recv":false,"debug-subscribe":false,"broker":"cdc76a83.f7bb88","x":470,"y":80,"wires":[["ff8ab3f7.28c5b","43d6e4dd.d4a3cc"]]},{"id":"fca1a064.9f2aa","type":"function","z":"3dddaeea.f4e652","name":"MQTT Topic","func":"var unit = global.get(\"unit\");\nmsg.topic = \"GW/\"+unit+\"/#\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":310,"y":80,"wires":[["19d6ecab.3811a3"]]},{"id":"1efedd60.12e2e3","type":"inject","z":"3dddaeea.f4e652","name":"Update","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":100,"y":40,"wires":[["fca1a064.9f2aa"]]},{"id":"78fc320c.8e251c","type":"function","z":"3dddaeea.f4e652","name":"G1 Data","func":"var unit = global.get(\"unit\");\nvar data = global.get(\"Geyser1Data\");\nif (msg.topic == \"GW/\"+unit+\"/S/Time/G\")\n{\n    data.Time.Y = msg.payload.Y;\n    data.Time.M = msg.payload.M;\n    data.Time.D = msg.payload.D;\n    data.Time.h = msg.payload.h;\n    data.Time.m = msg.payload.m;\n}\nif (msg.topic == \"GW/\"+unit+\"/1/a\")\n{\n    data.Power.I.AC = msg.payload.I.AC;\n    data.Power.I.PV = msg.payload.I.PV;\n}\nif (msg.topic == \"GW/\"+unit+\"/1/A\")\n{\n    data.Analog.T.G = msg.payload.T.G;\n    data.Analog.T.PCB = msg.payload.T.PCB;\n    data.Analog.I.AC = msg.payload.I.AC;\n    data.Analog.I.PV = msg.payload.I.PV;\n}\nif (msg.topic == \"GW/\"+unit+\"/1/STS\")\n{\n    data.Status.A.Tr_Th = msg.payload.A.Tr_Th;\n    data.Status.A.Tr_DR = msg.payload.A.Tr_DR;\n    data.Status.A.Tr_CS = msg.payload.A.Tr_CS;\n    data.Status.A.Tr_PCB = msg.payload.A.Tr_PCB;\n    data.Status.A.A_Sc = msg.payload.A.A_Sc;\n    data.Status.A.A_An = msg.payload.A.A_An;\n    data.Status.A.A_DT = msg.payload.A.A_DT;\n    data.Status.O.AC = msg.payload.O.AC;\n    data.Status.O.PV = msg.payload.O.PV;\n    data.Status.T = msg.payload.T;\n    data.Status.H = msg.payload.H;\n}\nif (msg.topic == \"GW/\"+unit+\"/1/SET\")\n{\n    data.Settings.O.ACM = msg.payload.O.ACM;\n    data.Settings.O.ACO = msg.payload.O.ACO;\n    data.Settings.O.PVM = msg.payload.O.PVM;\n}\nif (msg.topic == \"GW/\"+unit+\"/1/Time/1\")\n{\n    data.Timer1.C = msg.payload.C;\n    data.Timer1.S.h = msg.payload.S.h;\n    data.Timer1.S.m = msg.payload.S.m;\n    data.Timer1.E.h = msg.payload.E.h;\n    data.Timer1.E.m = msg.payload.E.m;\n    data.Timer1.W.Mo = msg.payload.W.Mo;\n    data.Timer1.W.Tu = msg.payload.W.Tu;\n    data.Timer1.W.We = msg.payload.W.We;\n    data.Timer1.W.Th = msg.payload.W.Th;\n    data.Timer1.W.Fr = msg.payload.W.Fr;\n    data.Timer1.W.Sa = msg.payload.W.Sa;\n    data.Timer1.W.Su = msg.payload.W.Su;\n}\nif (msg.topic == \"GW/\"+unit+\"/1/Time/2\")\n{\n    data.Timer2.C = msg.payload.C;\n    data.Timer2.S.h = msg.payload.S.h;\n    data.Timer2.S.m = msg.payload.S.m;\n    data.Timer2.E.h = msg.payload.E.h;\n    data.Timer2.E.m = msg.payload.E.m;\n    data.Timer2.W.Mo = msg.payload.W.Mo;\n    data.Timer2.W.Tu = msg.payload.W.Tu;\n    data.Timer2.W.We = msg.payload.W.We;\n    data.Timer2.W.Th = msg.payload.W.Th;\n    data.Timer2.W.Fr = msg.payload.W.Fr;\n    data.Timer2.W.Sa = msg.payload.W.Sa;\n    data.Timer2.W.Su = msg.payload.W.Su;\n}\nif (msg.topic == \"GW/\"+unit+\"/1/Time/3\")\n{\n    data.Timer3.C = msg.payload.C;\n    data.Timer3.S.h = msg.payload.S.h;\n    data.Timer3.S.m = msg.payload.S.m;\n    data.Timer3.E.h = msg.payload.E.h;\n    data.Timer3.E.m = msg.payload.E.m;\n    data.Timer3.W.Mo = msg.payload.W.Mo;\n    data.Timer3.W.Tu = msg.payload.W.Tu;\n    data.Timer3.W.We = msg.payload.W.We;\n    data.Timer3.W.Th = msg.payload.W.Th;\n    data.Timer3.W.Fr = msg.payload.W.Fr;\n    data.Timer3.W.Sa = msg.payload.W.Sa;\n    data.Timer3.W.Su = msg.payload.W.Su;\n}\n\n//msg.payload = data;\nglobal.set(\"Geyser1Data\", data);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":740,"y":80,"wires":[["1acdcccc.cbb883","3b11cbd4.9df1e4"]]},{"id":"ce1d56b2.5b7918","type":"inject","z":"3dddaeea.f4e652","name":"Unsubscribe","props":[{"p":"unsubscribe","v":"all","vt":"str"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payloadType":"str","x":110,"y":80,"wires":[["19d6ecab.3811a3"]]},{"id":"88f4714a.d1e3c","type":"complete","z":"3dddaeea.f4e652","name":"T1","scope":["bb63b27f.95085","9277515.474c9b"],"uncaught":false,"x":130,"y":540,"wires":[["69bfa0d5.33483"]]},{"id":"89246f36.fcc66","type":"complete","z":"3dddaeea.f4e652","name":"T2","scope":["69bfa0d5.33483"],"uncaught":false,"x":130,"y":580,"wires":[["d5382146.1c816"]]},{"id":"cd6957d6.6ed0d8","type":"complete","z":"3dddaeea.f4e652","name":"T3","scope":["d5382146.1c816"],"uncaught":false,"x":130,"y":620,"wires":[["5ec92086.19388"]]},{"id":"be6ce211.e3cd7","type":"mqtt out","z":"3dddaeea.f4e652","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":490,"y":260,"wires":[]},{"id":"57658c95.7efe04","type":"mqtt out","z":"3dddaeea.f4e652","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":490,"y":500,"wires":[]},{"id":"69bfa0d5.33483","type":"function","z":"3dddaeea.f4e652","name":"Timer 2","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/Time/2\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":540,"wires":[["57658c95.7efe04"]]},{"id":"d5382146.1c816","type":"function","z":"3dddaeea.f4e652","name":"Timer 3","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/Time/3\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":580,"wires":[["57658c95.7efe04"]]},{"id":"5ec92086.19388","type":"function","z":"3dddaeea.f4e652","name":"Timer 4","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/Time/4\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":620,"wires":[["57658c95.7efe04"]]},{"id":"26d16b08.99b954","type":"complete","z":"3dddaeea.f4e652","name":"T4","scope":["5ec92086.19388"],"uncaught":false,"x":130,"y":660,"wires":[["67681489.1825ac"]]},{"id":"67681489.1825ac","type":"function","z":"3dddaeea.f4e652","name":"Holiday","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/1/H\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":660,"wires":[["57658c95.7efe04"]]},{"id":"a34f4a30.383618","type":"mqtt out","z":"94e0adf3.31d6b","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":870,"y":120,"wires":[]},{"id":"dca728c5.82e408","type":"mqtt out","z":"94e0adf3.31d6b","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":790,"y":700,"wires":[]},{"id":"8fbc00d6.eaa39","type":"mqtt out","z":"90588a53.b682a8","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":790,"y":60,"wires":[]},{"id":"336df394.c0050c","type":"function","z":"90588a53.b682a8","name":"set Timer2","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/1/Time/2\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":100,"wires":[["8fbc00d6.eaa39"]]},{"id":"f54ba2dd.00d2","type":"function","z":"90588a53.b682a8","name":"set Timer3","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/1/Time/3\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":140,"wires":[["8fbc00d6.eaa39"]]},{"id":"5ab12939.d38588","type":"function","z":"90588a53.b682a8","name":"set Timer4","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/1/Time/4\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":180,"wires":[["8fbc00d6.eaa39"]]},{"id":"eaed139a.40259","type":"function","z":"90588a53.b682a8","name":"set payload","func":"var payload = global.get(\"Geyser1Data\");\nif(msg.topic == \"Enable\")\n{\n    payload.Timer1.C = msg.payload;\n}\nif(msg.topic == \"Monday\")\n{\n    payload.Timer1.W.Mo = msg.payload;\n}\nif(msg.topic == \"Tuesday\")\n{\n    payload.Timer1.W.Tu = msg.payload;\n}\nif(msg.topic == \"Wednesday\")\n{\n    payload.Timer1.W.We = msg.payload;\n}\nif(msg.topic == \"Thursday\")\n{\n    payload.Timer1.W.Th = msg.payload;\n}\nif(msg.topic == \"Friday\")\n{\n    payload.Timer1.W.Fr = msg.payload;\n}\nif(msg.topic == \"Saturday\")\n{\n    payload.Timer1.W.Sa = msg.payload;\n}\nif(msg.topic == \"Sunday\")\n{\n    payload.Timer1.W.Su = msg.payload;\n}\nif(msg.topic == \"OnTime\")\n{\n    var time = new Date(msg.payload);\n    var hour = time.getUTCHours();\n    var min = time.getMinutes();\n    \n    payload.Timer1.S.h = hour;\n    payload.Timer1.S.m = min;\n}\nif(msg.topic == \"OffTime\")\n{\n    var time2 = new Date(msg.payload);\n    var hour2 = time2.getUTCHours();\n    var min2 = time2.getMinutes();\n    \n    payload.Timer1.E.h = hour2;\n    payload.Timer1.E.m = min2;\n}\nglobal.set(\"Geyser1Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":540,"wires":[[]]},{"id":"9cb437fb.7c0b68","type":"ui_button","z":"3dddaeea.f4e652","name":"","group":"9a9a4f5d.b30e5","order":4,"width":0,"height":0,"passthru":false,"label":"Initialize New Unit","tooltip":"","color":"","bgcolor":"","icon":"","payload":"all","payloadType":"str","topic":"topic","topicType":"msg","x":110,"y":120,"wires":[["b57c9d8f.6b148","780da2b5.bcf32c","265077fb.9933d8"]]},{"id":"b57c9d8f.6b148","type":"change","z":"3dddaeea.f4e652","name":"Unsubscribe","rules":[{"t":"set","p":"unsubscribe","pt":"msg","to":"all","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":120,"wires":[["19d6ecab.3811a3","2de47555.c78e9a"]]},{"id":"e2f1b44c.b22568","type":"comment","z":"3dddaeea.f4e652","name":"Units","info":"Kemp - gwCECC50E32854A4\nAttie - gw2E2C3AE83E8294\nDual Test - gw2E2C3AE83E8341\nTest Bench - gw6A68C63ADADB1D","x":290,"y":40,"wires":[]},{"id":"2de47555.c78e9a","type":"delay","z":"3dddaeea.f4e652","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":460,"y":120,"wires":[["d4650c2e.0bf27"]]},{"id":"d4650c2e.0bf27","type":"change","z":"3dddaeea.f4e652","name":"Clear Payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"date"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":120,"wires":[["fca1a064.9f2aa"]]},{"id":"da830c86.b97e9","type":"inject","z":"3dddaeea.f4e652","name":"Update","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":100,"y":900,"wires":[["daa6490b.923288"]]},{"id":"daa6490b.923288","type":"function","z":"3dddaeea.f4e652","name":"Power 2 Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/a\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":920,"wires":[["a2633eaa.50bcb"]]},{"id":"266a4a4d.77b576","type":"function","z":"3dddaeea.f4e652","name":"Analogue 2 Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/A\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":310,"y":960,"wires":[["a2633eaa.50bcb"]]},{"id":"14eddfc.03f2c2","type":"function","z":"3dddaeea.f4e652","name":"Status 2 Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/STS\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":1000,"wires":[["a2633eaa.50bcb"]]},{"id":"c011f9ce.aae9d8","type":"function","z":"3dddaeea.f4e652","name":"Settings 2 Data","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/SET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":1040,"wires":[["a2633eaa.50bcb"]]},{"id":"1259d240.eb683e","type":"function","z":"3dddaeea.f4e652","name":"2 Timer 1","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/Time/1\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":1120,"wires":[["2b60a3eb.76caec"]]},{"id":"eb4f7bb1.92d308","type":"complete","z":"3dddaeea.f4e652","name":"Power Complete","scope":["daa6490b.923288"],"uncaught":false,"x":100,"y":960,"wires":[["266a4a4d.77b576"]]},{"id":"276949cd.179b86","type":"complete","z":"3dddaeea.f4e652","name":"Analog Complete","scope":["266a4a4d.77b576"],"uncaught":false,"x":100,"y":1000,"wires":[["14eddfc.03f2c2"]]},{"id":"1e1779c.8c66786","type":"complete","z":"3dddaeea.f4e652","name":"Status Complete","scope":["14eddfc.03f2c2"],"uncaught":false,"x":100,"y":1040,"wires":[["c011f9ce.aae9d8"]]},{"id":"6441a686.2ed578","type":"complete","z":"3dddaeea.f4e652","name":"Sequence Complete","scope":["c011f9ce.aae9d8"],"uncaught":false,"x":110,"y":1080,"wires":[["3ce40ab3.4ceeb6"]]},{"id":"3ce40ab3.4ceeb6","type":"link out","z":"3dddaeea.f4e652","name":"HTTP Req Complete 1","links":["d3263605.ab9d18","dba7953d.de8d18"],"x":255,"y":1080,"wires":[]},{"id":"e35e7978.1493b8","type":"link in","z":"3dddaeea.f4e652","name":"Refresh1","links":["e848606e.0ad76"],"x":155,"y":920,"wires":[["daa6490b.923288"]]},{"id":"7013cb5f.e39b24","type":"link in","z":"3dddaeea.f4e652","name":"Timers 1 Data","links":["d41c91f1.a0978"],"x":155,"y":1140,"wires":[["1259d240.eb683e"]]},{"id":"954a880c.799ca8","type":"complete","z":"3dddaeea.f4e652","name":"Timers Complete","scope":["19936eda.87b7d1"],"uncaught":false,"x":100,"y":1320,"wires":[["64ee53dd.bd4cdc"]]},{"id":"97a77cec.ff957","type":"inject","z":"3dddaeea.f4e652","name":"Update","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":1120,"wires":[["1259d240.eb683e"]]},{"id":"2b07af82.2d741","type":"complete","z":"3dddaeea.f4e652","name":"T1","scope":["1259d240.eb683e"],"uncaught":false,"x":130,"y":1160,"wires":[["46b1e5a0.1dc6bc"]]},{"id":"8ac82dbb.fb9db","type":"complete","z":"3dddaeea.f4e652","name":"T2","scope":["46b1e5a0.1dc6bc"],"uncaught":false,"x":130,"y":1200,"wires":[["27970695.65552a"]]},{"id":"7c52e7bb.be1798","type":"complete","z":"3dddaeea.f4e652","name":"T3","scope":["27970695.65552a"],"uncaught":false,"x":130,"y":1240,"wires":[["cbe05d55.c13d2"]]},{"id":"a2633eaa.50bcb","type":"mqtt out","z":"3dddaeea.f4e652","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":490,"y":920,"wires":[]},{"id":"2b60a3eb.76caec","type":"mqtt out","z":"3dddaeea.f4e652","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":490,"y":1120,"wires":[]},{"id":"46b1e5a0.1dc6bc","type":"function","z":"3dddaeea.f4e652","name":"2 Timer 2","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/Time/2\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":1160,"wires":[["2b60a3eb.76caec"]]},{"id":"27970695.65552a","type":"function","z":"3dddaeea.f4e652","name":"2 Timer 3","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/Time/3\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":1200,"wires":[["2b60a3eb.76caec"]]},{"id":"cbe05d55.c13d2","type":"function","z":"3dddaeea.f4e652","name":"2 Timer 4","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/Time/4\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":1240,"wires":[["2b60a3eb.76caec"]]},{"id":"bea3aca5.ea5f2","type":"complete","z":"3dddaeea.f4e652","name":"T4","scope":["cbe05d55.c13d2"],"uncaught":false,"x":130,"y":1280,"wires":[["19936eda.87b7d1"]]},{"id":"19936eda.87b7d1","type":"function","z":"3dddaeea.f4e652","name":"Holiday 2","func":"var addr = global.get(\"IP\");\nvar unit = global.get(\"unit\");\nmsg.topic = \"GWA/\"+unit+\"/2/H\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":1280,"wires":[["2b60a3eb.76caec"]]},{"id":"f707e187.0f87e","type":"mqtt out","z":"e34d9a79.0942a8","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":910,"y":120,"wires":[]},{"id":"6beefe47.cd93e","type":"function","z":"e34d9a79.0942a8","name":"ACT","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"S\":{\n    \t\t\t\t    \"ACT\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/2/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":120,"wires":[["f707e187.0f87e"]]},{"id":"29dc236b.41095c","type":"function","z":"e34d9a79.0942a8","name":"ACOT","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"S\":{\n    \t\t\t\t    \"ACOT\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/2/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\n\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":140,"wires":[["f707e187.0f87e"]]},{"id":"7ad3c472.479ccc","type":"function","z":"e34d9a79.0942a8","name":"PVT","func":"var payload;\nvar output\t= [];\nif(msg.payload > 70)    // limit to 70\n{\n    payload = 70;\n}\nelse\n{\n    payload = msg.payload;\n}\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"S\":{\n    \t\t\t\t    \"PVT\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/2/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\n\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":160,"wires":[["f707e187.0f87e"]]},{"id":"4fc59c3a.44dfd4","type":"function","z":"e34d9a79.0942a8","name":"AC On/Off","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"O\":{\n    \t\t\t\t    \"ACM\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/2/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nnode.status({text:msg.payload});\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":400,"wires":[["f707e187.0f87e"]]},{"id":"f46cef83.00edb","type":"function","z":"e34d9a79.0942a8","name":"Boost On/Off","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"O\":{\n    \t\t\t\t    \"ACO\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/2/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":420,"wires":[["f707e187.0f87e"]]},{"id":"c3c318f1.10aa28","type":"function","z":"e34d9a79.0942a8","name":"PV On/Off","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"O\":{\n    \t\t\t\t    \"PVM\": payload\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/2/SET\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":440,"wires":[["f707e187.0f87e"]]},{"id":"aee33132.ead81","type":"function","z":"e34d9a79.0942a8","name":"Reset","func":"var payload = msg.payload;\nvar output\t= [];\n\nvar setpoint = {\n        \"payload\": {\n\t\t\t\t    \"A\":{\n    \t\t\t\t    \"Tr_DR\": \"\",\n    \t\t\t\t    \"A_Sc\": \"\",\n    \t\t\t\t    \"A_An\": \"\",\n    \t\t\t\t    \"A_DT\": \"\"\n    \t\t\t\t}\n        },\n    \t\"topic\": \"GWR/\"+global.get(\"unit\")+\"/2/STS\"\n};\n\t\t//-----------------------------------------------------------------------------------------\n\noutput\t=\t[\n\t\t\t\tsetpoint\n\t\t\t];\nnode.status({text:msg.payload});\nreturn output;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":460,"wires":[["f707e187.0f87e"]]},{"id":"5e95ed02.097204","type":"function","z":"e34d9a79.0942a8","name":"Set value","func":"var payload = msg.payload;\n\nmsg.payload = {\"C\":payload};\nmsg.topic = \"GWR/\"+flow.get(\"unit\")+\"/2/Time\";\nnode.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":660,"y":700,"wires":[["e5245895.935178"]]},{"id":"e5245895.935178","type":"mqtt out","z":"e34d9a79.0942a8","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":810,"y":700,"wires":[]},{"id":"d076d7c8.ec5ec8","type":"function","z":"1d8af5ee.d9dbda","name":"set Timer1","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/2/Time/1\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":60,"wires":[["abacc9dc.f634a8"]]},{"id":"abacc9dc.f634a8","type":"mqtt out","z":"1d8af5ee.d9dbda","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":730,"y":60,"wires":[]},{"id":"46f6547b.11f8fc","type":"function","z":"1d8af5ee.d9dbda","name":"set Timer2","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/2/Time/2\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":100,"wires":[["abacc9dc.f634a8"]]},{"id":"e931e008.ece44","type":"function","z":"1d8af5ee.d9dbda","name":"set Timer3","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/2/Time/3\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":140,"wires":[["abacc9dc.f634a8"]]},{"id":"411589de.63bf58","type":"function","z":"1d8af5ee.d9dbda","name":"set Timer4","func":"msg.topic = \"GWR/\"+global.get(\"unit\")+\"/2/Time/4\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":180,"wires":[["abacc9dc.f634a8"]]},{"id":"9e7ab32a.71553","type":"function","z":"1d8af5ee.d9dbda","name":"Timer 1","func":"var payload = global.get(\"Geyser2Data\");\nmsg.data = payload.Timer1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":420,"wires":[["d905f164.2c1c"]]},{"id":"d905f164.2c1c","type":"subflow:65f07aa6.9889a4","z":"1d8af5ee.d9dbda","name":"Timer 1","env":[],"x":420,"y":420,"wires":[["dca1e884.91d4f8"],["ebd1cf4f.8f929"],["7b459e98.f"],["b0321a41.9bd568"],["9ae810a3.a4fbc"],["db7ec5e3.6e35c8"],["a89969d2.769f68"],["1f7ec4da.13239b"],["cbf89cf8.72db6"],["b540cec3.d8b85"]]},{"id":"45d483af.becc0c","type":"function","z":"1d8af5ee.d9dbda","name":"set payload","func":"var payload = global.get(\"Geyser2Data\");\nif(msg.topic == \"Enable\")\n{\n    payload.Timer1.C = msg.payload;\n}\nif(msg.topic == \"Monday\")\n{\n    payload.Timer1.W.Mo = msg.payload;\n}\nif(msg.topic == \"Tuesday\")\n{\n    payload.Timer1.W.Tu = msg.payload;\n}\nif(msg.topic == \"Wednesday\")\n{\n    payload.Timer1.W.We = msg.payload;\n}\nif(msg.topic == \"Thursday\")\n{\n    payload.Timer1.W.Th = msg.payload;\n}\nif(msg.topic == \"Friday\")\n{\n    payload.Timer1.W.Fr = msg.payload;\n}\nif(msg.topic == \"Saturday\")\n{\n    payload.Timer1.W.Sa = msg.payload;\n}\nif(msg.topic == \"Sunday\")\n{\n    payload.Timer1.W.Su = msg.payload;\n}\nif(msg.topic == \"OnTime\")\n{\n    var time = new Date(msg.payload);\n    var hour = time.getUTCHours();\n    var min = time.getMinutes();\n    \n    payload.Timer1.S.h = hour;\n    payload.Timer1.S.m = min;\n}\nif(msg.topic == \"OffTime\")\n{\n    var time2 = new Date(msg.payload);\n    var hour2 = time2.getUTCHours();\n    var min2 = time2.getMinutes();\n    \n    payload.Timer1.E.h = hour2;\n    payload.Timer1.E.m = min2;\n}\nglobal.set(\"Geyser2Data\", payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":340,"wires":[[]]},{"id":"75a1f504.64107c","type":"subflow:65f07aa6.9889a4","z":"1d8af5ee.d9dbda","name":"Timer 2","env":[],"x":420,"y":800,"wires":[["bac3d087.88b36"],["31e89715.9ccf28"],["8eecf20c.00f31"],["7abef5b.989620c"],["e4d37581.09dde8"],["2bcf2b92.43b264"],["2c20a1c7.4d0ffe"],["fb972ff8.f5b57"],["b60208c3.b5d828"],["195e7caa.7d9c63"]]},{"id":"e04893e1.63fe4","type":"function","z":"1d8af5ee.d9dbda","name":"Timer 2","func":"var payload = global.get(\"Geyser2Data\");\nmsg.data = payload.Timer2;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":800,"wires":[["75a1f504.64107c"]]},{"id":"21ed096a.e7f606","type":"debug","z":"3dddaeea.f4e652","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":490,"y":240,"wires":[]},{"id":"49095220.6179bc","type":"mqtt out","z":"5395d339.48846c","name":"MQTT","topic":"","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cdc76a83.f7bb88","x":630,"y":580,"wires":[]},{"id":"fc9c74bd.1af2c8","type":"debug","z":"5395d339.48846c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":610,"y":420,"wires":[]},{"id":"fbb57feb.81c8a","type":"debug","z":"94e0adf3.31d6b","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":140,"y":180,"wires":[]},{"id":"43d6e4dd.d4a3cc","type":"debug","z":"3dddaeea.f4e652","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":660,"y":40,"wires":[]},{"id":"ce70b91d.770bf8","type":"mqtt in","z":"3dddaeea.f4e652","name":"","topic":"GW/gwCECC50E32854A4/1/STS","qos":"0","datatype":"auto","broker":"cdc76a83.f7bb88","nl":false,"rap":true,"rh":0,"x":550,"y":180,"wires":[["6712e481.c73cdc"]]},{"id":"670a8f2c.f5388","type":"debug","z":"3dddaeea.f4e652","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":870,"y":180,"wires":[]},{"id":"6712e481.c73cdc","type":"json","z":"3dddaeea.f4e652","name":"","property":"payload","action":"","pretty":false,"x":750,"y":180,"wires":[["670a8f2c.f5388"]]},{"id":"a3027afe.bc02f8","type":"inject","z":"3dddaeea.f4e652","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"{\"Power\":{\"I\":{\"AC\":0,\"PV\":0}},\"Analog\":{\"T\":{\"G\":0,\"PCB\":0},\"I\":{\"AC\":0,\"PV\":0},\"V\":{\"AC\":0,\"PV\":0}},\"Status\":{\"A\":{\"Tr_Te\":0,\"Tr_DR\":0,\"Tr_CS\":0,\"Tr_PCB\":0,\"A_Sc\":0,\"A_An\":0,\"A_DT\":0},\"O\":{\"AC\":0,\"PV\":0},\"T\":0,\"H\":0},\"Settings\":{\"O\":{\"ACM\":0,\"ACO\":0,\"PVM\":0},\"S\":{\"ACT\":0,\"ACOT\":0,\"PVT\":0,\"ACCT\":0},\"A\":{\"DRT\":0,\"SCB\":0}},\"Time\":{\"Y\":0,\"M\":0,\"D\":0,\"h\":0,\"m\":0},\"Timers\":{\"C\":0},\"Timer1\":{\"C\":0,\"S\":{\"h\":0,\"m\":0},\"E\":{\"h\":0,\"m\":0},\"W\":{\"Mo\":0,\"Tu\":0,\"We\":0,\"Th\":0,\"Fr\":0,\"Sa\":0,\"Su\":0}},\"Timer2\":{\"C\":0,\"S\":{\"h\":0,\"m\":0},\"E\":{\"h\":0,\"m\":0},\"W\":{\"Mo\":0,\"Tu\":0,\"We\":0,\"Th\":0,\"Fr\":0,\"Sa\":0,\"Su\":0}},\"Timer3\":{\"C\":0,\"S\":{\"h\":0,\"m\":0},\"E\":{\"h\":0,\"m\":0},\"W\":{\"Mo\":0,\"Tu\":0,\"We\":0,\"Th\":0,\"Fr\":0,\"Sa\":0,\"Su\":0}},\"Timer4\":{\"C\":0,\"S\":{\"h\":0,\"m\":0},\"E\":{\"h\":0,\"m\":0},\"W\":{\"Mo\":0,\"Tu\":0,\"We\":0,\"Th\":0,\"Fr\":0,\"Sa\":0,\"Su\":0}},\"Holiday\":{\"C\":0,\"S\":{\"Y\":2019,\"M\":1,\"D\":1},\"E\":{\"Y\":2019,\"M\":1,\"D\":2},\"D\":1}}","payloadType":"json","x":150,"y":160,"wires":[["265077fb.9933d8","780da2b5.bcf32c"]]},{"id":"780da2b5.bcf32c","type":"change","z":"3dddaeea.f4e652","name":"","rules":[{"t":"set","p":"Geyser2Data","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":160,"wires":[[]]},{"id":"265077fb.9933d8","type":"change","z":"3dddaeea.f4e652","name":"","rules":[{"t":"set","p":"Geyser1Data","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":180,"wires":[[]]}]
